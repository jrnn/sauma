(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{263:function(e,t,a){e.exports=a(454)},453:function(e,t,a){},454:function(e,t,a){"use strict";a.r(t);var n=a(10),r=a(12),c=a(11),o=a(13),i=a(0),l=a.n(i),u=a(463),s=function(){return l.a.createElement("div",{className:"full-width-bg-blue"},l.a.createElement("div",{className:"wrapper padded"},l.a.createElement(u.a,null,l.a.createElement("h1",{className:"top-header"},"Sauma"))))},d=a(474),m=a(475),p=a(54),E=function(e){function t(e){var a;return Object(n.a)(this,t),(a=Object(r.a)(this,Object(c.a)(t).call(this,e))).toggle=function(){return a.setState({active:!a.state.active})},a.render=function(){var e=a.state.active;return l.a.createElement("div",{className:"accordion"},l.a.createElement(d.a,{onClick:a.toggle,style:{cursor:"pointer",padding:"1.5rem 0rem"}},l.a.createElement(d.a.Column,{floated:"left",width:13},l.a.createElement(m.a,{content:a.props.title})),l.a.createElement(d.a.Column,{floated:"right",textAlign:"right",width:3},l.a.createElement(p.a,{name:e?"chevron down":"chevron up"}))),l.a.createElement("div",{style:{display:e?"":"none",padding:"1rem 0rem 3rem 0rem"}},a.props.children))},a.state={active:e.active||!1},a}return Object(o.a)(t,e),t}(l.a.Component),f=E,h=a(20),v=a(28),b=a(95),O=function(e){var t=e.error;return t?l.a.createElement(b.a,{basic:!0,color:"red",content:t,pointing:!0}):null},y=a(468),g=a(464),k=a(465),j=function(e){var t=e.activity,a=e.errors,n=e.onChange,r=e.readOnly,c=e.state;return l.a.createElement("div",null,l.a.createElement(y.a.Field,null,l.a.createElement("label",null,"Teht\xe4v\xe4"),l.a.createElement(g.a,{disabled:!0,value:t.id?"".concat(t.project.projectId," \u2014 ").concat(t.task.name):"".concat(t.task.project.projectId," \u2014 ").concat(t.task.name)})),l.a.createElement(y.a.Field,null,l.a.createElement("label",null,"Tekij\xe4"),l.a.createElement(g.a,{disabled:!0,value:t.id?"".concat(t.owner.firstName," ").concat(t.owner.lastName):e.owner||""})),l.a.createElement(y.a.Field,{error:void 0!==a.description},l.a.createElement("label",null,"Kuvaus"),l.a.createElement(k.a,{autoHeight:!0,name:"description",onChange:n,placeholder:"Kirjoita kuvaus mit\xe4 tehty",readOnly:r,style:{minHeight:100},value:c.description}),l.a.createElement(O,{error:a.description})),l.a.createElement(y.a.Field,{error:void 0!==a.date},l.a.createElement("label",null,"P\xe4iv\xe4m\xe4\xe4r\xe4"),l.a.createElement(g.a,{icon:"calendar",name:"date",onChange:n,placeholder:"pp-kk-vvvv",readOnly:r,type:"date",value:c.date}),l.a.createElement(O,{error:a.date})),l.a.createElement(y.a.Field,{error:void 0!==a.hours},l.a.createElement("label",null,"Ty\xf6tunnit"),l.a.createElement(g.a,{label:{basic:!0,content:"tuntia"},labelPosition:"right",name:"hours",onChange:n,placeholder:"Py\xf6ristyy l\xe4himp\xe4\xe4n kokonaislukuun",readOnly:r,value:c.hours}),l.a.createElement(O,{error:a.hours})),l.a.createElement(y.a.Field,{className:"padded"},l.a.createElement(y.a.Checkbox,{checked:c.contractScope,label:"Urakan puitteissa",name:"contractScope",onChange:n,readOnly:r})))},w=a(37),C=a(471),T=a(455),R=a(470),I=function(e){return l.a.createElement("div",null,l.a.createElement(y.a.Field,null,l.a.createElement("label",null,e.header),l.a.createElement(C.a,{divided:!0,relaxed:!0,verticalAlign:"middle"},e.state.quotas.map(function(t){return a=t.material,n=t.quantity,r=e.onChange,c=e.onDelete,o=e.readOnly,l.a.createElement(C.a.Item,{key:a.id},l.a.createElement(C.a.Content,{floated:"right"},l.a.createElement(g.a,{name:a.id,onChange:r,readOnly:o,style:{width:"60px"},transparent:!0,value:n}),o?null:l.a.createElement(T.a,{basic:!0,compact:!0,icon:"delete",name:a.id,onClick:c})),l.a.createElement(C.a.Content,null,l.a.createElement(C.a.Header,{content:a.name}),l.a.createElement(C.a.Description,{content:a.unit})));var a,n,r,c,o}))),e.readOnly?null:l.a.createElement(y.a.Field,null,l.a.createElement(R.a,{name:"material",onChange:e.onAdd,options:e.options,placeholder:"Lis\xe4\xe4 uusi materiaali",search:!0,selection:!0,value:""})))},S=a(7),_=function(e,t){var a=t.map(function(e){return e.material.id});return e.filter(function(e){return!a.includes(e.id)}).sort(function(e,t){return e.name.localeCompare(t.name)}).map(function(e){return{key:e.id,text:e.name,value:e.id}})},A=function(e,t){return e.filter(function(e){return!t.employees.includes(e.id)}).map(function(e){return{key:e.id,text:"".concat(e.lastName,", ").concat(e.firstName),value:e.id}}).sort(function(e,t){return e.text.localeCompare(t.text)})},D=function(e){function t(e){var a;return Object(n.a)(this,t),(a=Object(r.a)(this,Object(c.a)(t).call(this,e))).handleAdd=function(e,t){var n=t.value,r=a.props.materials.find(function(e){return e.id===n}),c=[].concat(Object(w.a)(a.state.quotas),[{material:r,quantity:0}]);a.setState({quotas:c}),a.props.sync(c)},a.handleChange=function(e,t){var n=t.name,r=t.value,c=a.state.quotas.map(function(e){return e.material.id===n?Object(h.a)({},e,{quantity:r}):e});a.setState({quotas:c}),a.props.sync(c)},a.handleDelete=function(e,t){var n=t.name;e.preventDefault();var r=a.state.quotas.filter(function(e){return e.material.id!==n});a.setState({quotas:r}),a.props.sync(r)},a.render=function(){return l.a.createElement(I,{header:a.props.header,onAdd:a.handleAdd,onChange:a.handleChange,onDelete:a.handleDelete,options:_(a.props.materials,a.state.quotas),readOnly:a.props.readOnly,state:a.state})},a.state={quotas:e.quotas},a}return Object(o.a)(t,e),t}(l.a.Component),N=Object(S.b)(function(e){return{materials:e.materials.data.items}},null)(D),x=function(e){try{return new Date(e).toISOString().substring(0,10)}catch(t){return""}},F=function(e){if(0===e.trim().length)return"NaN";var t=Number(e.replace(",","."));return isNaN(t)?"NaN":t},P=function(e){return e.filter(function(e){return e.quantity>0&&"NaN"!==F(e.quantity)}).map(function(e){return{material:e.material.id,quantity:F(e.quantity)}})},L=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return"?"!==e[0]?t:(e.substring(1).split("&").map(function(e){var a=decodeURIComponent(e.split("=")[0]),n=decodeURIComponent(e.split("=")[1]||"");return t[a]=n}),t)},H=function(e){return e.length<40?e:"".concat(e.substring(0,40),"...")},W=function(e){var t={description:e.description||"",hours:e.hours||"",quotas:e.quotas||[]};return t.date=e.date?x(e.date):"",t.contractScope=!e.id||e.contractScope,t.signed=!!e.id&&e.signed,t},K=function(e){return{city:e.city||"",country:e.country||"",street:e.street||"",streetExt:e.streetExt||"",zipCode:e.zipCode||""}},U=function(e){return{businessId:e.businessId||"",domicile:e.domicile||"",legalEntity:e.legalEntity||""}},M=function(e){var t={email:e.email||"",firstName:e.firstName||"",lastName:e.lastName||"",phone:e.phone||"",username:e.username||""};return t.administrator=!!e.id&&e.administrator,t.enabled=!e.id||e.enabled,t.address=K(e.address||{}),t},V=function(e){return{name:e.name||"",unit:e.unit||"",unitCost:e.unitCost||""}},q=function(e){var t={contactPerson:e.contactPerson||"",name:e.name||"",phone:e.phone||"",projectId:e.projectId||""};return t.endDate=e.endDate?x(e.endDate):"",t.startDate=e.startDate?x(e.startDate):"",t.client=e.client?e.client.id:null,t.manager=e.manager?e.manager.id:null,t.address=K(e.address||{}),t},G=function(e){var t={name:e.name||"",description:e.description||"",daysNeeded:e.daysNeeded||"",quotas:e.quotas||[]};return t.endDate=e.endDate?x(e.endDate):"",t.startDate=e.startDate?x(e.startDate):"",t.completed=!!e.id&&e.completed,t},z=a(466),Y=a(8),Q=a.n(Y),J=a(21),B=a(26),$=a.n(B),Z=function(e){return{headers:{authorization:"bearer ".concat(e)}}},X=function(e){var t=e.response.data.ValidationError;if(t)return{message:"Virheellinen tai puutteellinen sy\xf6te, tarkista antamasi tiedot",validation:t};switch(e.response.status){case 500:return{message:"Palvelin on nurin, kokeile hetken kuluttua uudelleen"};case 404:return{message:"Sivua/resurssia ei ole olemassa, tarkista osoite"};case 403:return{message:"Sinulla ei ole oikeuksia t\xe4h\xe4n sivuun/resurssiin"};case 401:return{message:"Istuntosi on vanhentunut, kirjaudu uudestaan"};default:return{message:"Voi vihveli, jotain meni nyt kaputt. Kokeilepa hetken kuluttua uudelleen...?"}}},ee=function(e,t){var a=e[t].data;return!(!a.updated||a.pending)&&6e4<Date.now()-a.updated},te=function(e){return{fetch:function(){return{type:e.FETCH}},fetchOk:function(t){return{type:e.FETCH_OK,payload:t}},fetchError:function(t){return{type:e.FETCH_ERROR,payload:t}},createOk:function(t){return{type:e.CREATED,payload:t}},updateOk:function(t){return{type:e.UPDATED,payload:t}},write:function(){return{type:e.WRITE}},writeError:function(){return{type:e.WRITE_ERROR}},writeInvalid:function(t){return{type:e.WRITE_INVALID,payload:t}}}},ae=function(e,t){return function(){var a=Object(J.a)(Q.a.mark(function a(n){return Q.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:setTimeout(function(){return n({type:"HIDE_NOTIFICATION"})},5e3),n({type:"SET_NOTIFICATION",payload:{message:e,type:t}});case 2:case"end":return a.stop()}},a)}));return function(e){return a.apply(this,arguments)}}()},ne="/api/activities",re={FETCH:"FETCH_ACTIVITIES",FETCH_OK:"FETCH_ACTIVITIES_OK",FETCH_ERROR:"FETCH_ACTIVITIES_ERROR",WRITE:"WRITE_ACTIVITY",WRITE_ERROR:"WRITE_ACTIVITY_ERROR",WRITE_INVALID:"WRITE_ACTIVITY_INVALID",WRITE_RESET:"RESET_WRITE_ACTIVITY",CREATED:"CREATE_ACTIVITY_OK",UPDATED:"UPDATE_ACTIVITY_OK"},ce=te(re),oe=function(){return{type:re.WRITE_RESET}},ie=function(e){return function(){var t=Object(J.a)(Q.a.mark(function t(a){var n,r;return Q.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return a(ce.fetch()),t.prev=1,t.next=4,$.a.get(ne,Z(e));case 4:n=t.sent,a(ce.fetchOk(n.data)),t.next=12;break;case 8:t.prev=8,t.t0=t.catch(1),r=X(t.t0),a(ce.fetchError(r.message));case 12:case"end":return t.stop()}},t,null,[[1,8]])}));return function(e){return t.apply(this,arguments)}}()},le=function(e){return function(){var t=Object(J.a)(Q.a.mark(function t(a,n){return Q.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!ee(n(),"activities")){t.next=4;break}a(ie(e)),t.next=5;break;case 4:return t.abrupt("return",Promise.resolve());case 5:case"end":return t.stop()}},t)}));return function(e,a){return t.apply(this,arguments)}}()},ue=function(e,t,a){return function(){var n=Object(J.a)(Q.a.mark(function n(r){var c,o;return Q.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return r(ce.write()),n.prev=1,n.next=4,$.a.put("".concat(ne,"/").concat(e),t,Z(a));case 4:c=n.sent,r(oe()),r(ce.updateOk(c.data)),r(ae("Suoritteen tiedot p\xe4ivitetty","ok")),n.next=15;break;case 10:n.prev=10,n.t0=n.catch(1),(o=X(n.t0)).validation?r(ce.writeInvalid(o.validation)):r(ce.writeError()),r(ae(o.message,"error"));case 15:case"end":return n.stop()}},n,null,[[1,10]])}));return function(e){return n.apply(this,arguments)}}()},se=a(70),de=function(e){function t(e){var a;return Object(n.a)(this,t),(a=Object(r.a)(this,Object(c.a)(t).call(this,e))).handleChange=function(e,t){var n="checkbox"===t.type?t.checked:t.value;a.setState(Object(v.a)({},t.name,n))},a.handleSave=function(e){e.preventDefault(e);var t=a.props,n=t.auth,r=t.history,c=t.id,o=t.isNew,i=t.task;a.props.save(a.state,r,c,o,i,n.token)},a.handleSign=function(e){e.preventDefault(e);var t=a.props,n=t.auth,r=t.id;a.props.sign(r,n.token)},a.syncQuotaState=function(e){return a.setState(Object(h.a)({},a.state,{quotas:e}))},a.render=function(){var e=a.props,t=e.activity,n=e.auth,r=e.isNew,c=!r&&(n.admin&&!t.signed),o=!!r||!t.signed&&n.id===t.owner.id;return l.a.createElement(y.a,{loading:a.props.pending},l.a.createElement(j,{activity:t,errors:a.props.errors,onChange:a.handleChange,owner:"".concat(n.firstName," ").concat(n.lastName),readOnly:!o,state:a.state}),l.a.createElement(z.a,null),l.a.createElement(N,{header:"K\xe4ytetyt materiaalit",quotas:a.state.quotas,readOnly:!o,sync:a.syncQuotaState}),o?l.a.createElement("div",null,l.a.createElement(z.a,{hidden:!0}),l.a.createElement(T.a,{content:"Tallenna",fluid:!0,onClick:a.handleSave})):null,c?l.a.createElement("div",null,l.a.createElement(z.a,{hidden:!0}),l.a.createElement(T.a,{content:"Hyv\xe4ksy",fluid:!0,onClick:a.handleSign})):null)},a.state=W(e.activity),a}return Object(o.a)(t,e),t}(l.a.Component),me=Object(se.f)(Object(S.b)(function(e){return{auth:e.auth,errors:e.activities.write.errors,pending:e.activities.write.pending}},function(e){return{save:function(t,a,n,r,c,o){var i=Object(h.a)({},t,{hours:F(t.hours),quotas:P(t.quotas),task:c.id||null});return e(r?function(e,t,a){return function(){var n=Object(J.a)(Q.a.mark(function n(r){var c,o;return Q.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return r(ce.write()),n.prev=1,n.next=4,$.a.post(ne,e,Z(t));case 4:c=n.sent,r(oe()),r(ce.createOk(c.data)),r(ae("Suorite lis\xe4tty","ok")),a.replace("/activities/".concat(c.data.id)),n.next=16;break;case 11:n.prev=11,n.t0=n.catch(1),(o=X(n.t0)).validation?r(ce.writeInvalid(o.validation)):r(ce.writeError()),r(ae(o.message,"error"));case 16:case"end":return n.stop()}},n,null,[[1,11]])}));return function(e){return n.apply(this,arguments)}}()}(i,o,a):ue(n,i,o))},sign:function(t,a){e(function(e,t){return function(){var a=Object(J.a)(Q.a.mark(function a(n){var r,c;return Q.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return n(ce.write()),a.prev=1,a.next=4,$.a.put("".concat(ne,"/").concat(e,"/sign"),{},Z(t));case 4:r=a.sent,n(oe()),n(ce.updateOk(r.data)),n(ae("Suorite kirjattu hyv\xe4ksytyksi","ok")),a.next=15;break;case 10:a.prev=10,a.t0=a.catch(1),c=X(a.t0),n(ce.writeError()),n(ae(c.message,"error"));case 15:case"end":return a.stop()}},a,null,[[1,10]])}));return function(e){return a.apply(this,arguments)}}()}(t,a))}}})(de)),pe=function(e){var t=e.errors,a=e.state;return l.a.createElement(y.a,{loading:e.pending,onSubmit:e.onSubmit},l.a.createElement(y.a.Field,{error:null!==t.name},l.a.createElement("label",null,"Liitteen nimi / kuvaus"),l.a.createElement(g.a,{name:"name",onChange:e.onChange,value:a.name}),l.a.createElement(O,{error:t.name})),l.a.createElement(y.a.Field,{error:null!==t.file},l.a.createElement("label",null,"Valittu tiedosto"),l.a.createElement(g.a,{readOnly:!0,value:a.file&&a.file.name||""}),l.a.createElement(O,{error:t.file})),l.a.createElement(T.a,{content:"Valitse tiedosto",onClick:e.onClick,fluid:!0}),l.a.createElement(z.a,{hidden:!0}),l.a.createElement(T.a,{content:"Tallenna",disabled:null!==t.name||null!==t.file,fluid:!0}))},Ee=Number(Object({NODE_ENV:"production",PUBLIC_URL:"",REACT_APP_GOOGLE_API_KEY:"AIzaSyDUfeWoQWNiGLhumfauHAzvwPpIU5_dzMA"}).MAX_FILESIZE)||4194304,fe=new RegExp([/(^application\/msword$)|/,/(^application\/pdf$)|/,/(^application\/vnd.ms-)|/,/(^application\/vnd.openxmlformats-)|/,/(^application\/zip$)|/,/(^image\/)|/,/(^text\/csv$)/].map(function(e){return e.source}).join("")),he=function(e){return e?fe.test(e.type)?e.size>Ee?{valid:!1,error:"Tiedosto on liian suuri (maksimi ".concat((Ee/Math.pow(1024,2)).toFixed(2)," Mt)")}:{valid:!0}:{valid:!1,error:"Tiedostotyyppi ei ole tuettu"}:{valid:!1,error:"Ei tiedostoa"}},ve=function(e){function t(){var e;return Object(n.a)(this,t),(e=Object(r.a)(this,Object(c.a)(t).call(this))).handleChange=function(t,a){var n=a.name,r=a.value;t.preventDefault(),e.setState(Object(v.a)({},n,r))},e.handleClick=function(t){t.preventDefault(),e.filePicker.click()},e.handleFilePick=function(t){t.preventDefault(),e.setState({file:t.target.files[0]})},e.handleSubmit=function(t){t.preventDefault();var a=new FormData;a.append("file",e.state.file),a.append("name",e.state.name),e.props.onSubmit(a),e.setState({file:null,name:""})},e.validateForm=function(){var t=he(e.state.file),a=e.state.name.trim();return{file:t.valid?null:t.error,name:a.length>0?null:"Liitteen nimi puuttuu"}},e.render=function(){return l.a.createElement("div",null,l.a.createElement(pe,{errors:e.validateForm(),onChange:e.handleChange,onClick:e.handleClick,onSubmit:e.handleSubmit,pending:e.props.pending,state:e.state}),l.a.createElement("input",{hidden:!0,onChange:e.handleFilePick,ref:function(t){return e.filePicker=t},type:"file"}))},e.state={file:null,name:""},e}return Object(o.a)(t,e),t}(l.a.Component),be=Object(S.b)(function(e){return{pending:e.attachments.pending}},null)(ve),Oe=function(){return l.a.createElement(C.a.Item,{disabled:!0},l.a.createElement(C.a.Content,{align:"center"},l.a.createElement(C.a.Header,{content:"( Ei osumia! )"}),l.a.createElement(C.a.Description,{content:"Joko lista on tyhj\xe4, tai hakuehtoja vastaavia merkint\xf6j\xe4 ei l\xf6ydy."})))},ye=a(23),ge=function(e){return l.a.createElement(C.a.Item,{as:ye.b,key:e.key,target:"_blank",to:e.url},l.a.createElement(C.a.Icon,{color:"grey",name:"file text outline",verticalAlign:"middle"}),l.a.createElement(C.a.Content,null,l.a.createElement(C.a.Header,{content:e.name}),l.a.createElement(C.a.Description,{content:"".concat(x(e.createdOn)," \u2014 ").concat(e.owner.firstName," ").concat(e.owner.lastName)})))},ke=function(e){var t=e.attachments;return l.a.createElement(C.a,{divided:!0,relaxed:!0},t.length>0?t.sort(function(e,t){return Date.parse(t.createdOn)-Date.parse(e.createdOn)}).map(ge):l.a.createElement(Oe,null))},je=function(e){function t(){var e;return Object(n.a)(this,t),(e=Object(r.a)(this,Object(c.a)(t).call(this))).toggle=function(){return e.setState({open:!e.state.open})},e.render=function(){return e.state.open?e.props.children:l.a.createElement(T.a,{content:e.props.button,fluid:!0,onClick:e.toggle})},e.state={open:!1},e}return Object(o.a)(t,e),t}(l.a.Component),we=je,Ce={REQUEST_START:"ATTACHMENT_START",REQUEST_OVER:"ATTACHMENT_OVER"},Te=function(e){function t(){var e,a;Object(n.a)(this,t);for(var o=arguments.length,i=new Array(o),u=0;u<o;u++)i[u]=arguments[u];return(a=Object(r.a)(this,(e=Object(c.a)(t)).call.apply(e,[this].concat(i)))).upload=function(e){var t=a.props,n=t.entity,r=t.id,c=t.thunk,o=t.token,i=t.uploadAttachment;e.append("id",r),e.append("entity",n),i(r,e,o,c,a.expandable.toggle)},a.render=function(){return l.a.createElement("div",null,l.a.createElement(ke,{attachments:a.props.attachments}),l.a.createElement(z.a,null),l.a.createElement(we,{button:"Lis\xe4\xe4 liite",ref:function(e){return a.expandable=e}},l.a.createElement(be,{onSubmit:a.upload})))},a}return Object(o.a)(t,e),t}(l.a.Component),Re=Object(S.b)(function(e){return{token:e.auth.token}},{uploadAttachment:function(e,t,a,n,r){return function(){var c=Object(J.a)(Q.a.mark(function c(o){var i,l;return Q.a.wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return o({type:Ce.REQUEST_START}),c.prev=1,c.next=4,$.a.post("/api/blobs",t,{headers:{authorization:"bearer ".concat(a),"content-type":"multipart/form-data"}});case 4:i=c.sent,o(n(e,i.data,a)),r&&r(),c.next=13;break;case 9:c.prev=9,c.t0=c.catch(1),l=X(c.t0),o(ae(l.message,"error"));case 13:o({type:Ce.REQUEST_OVER});case 14:case"end":return c.stop()}},c,null,[[1,9]])}));return function(e){return c.apply(this,arguments)}}()}})(Te),Ie=function(e){return l.a.createElement(y.a,{loading:e.pending,onSubmit:e.onSubmit},l.a.createElement(y.a.Field,{error:null!==e.error},l.a.createElement("label",null,"Lis\xe4\xe4 huomio"),l.a.createElement(k.a,{autoHeight:!0,onChange:e.onChange,placeholder:"Korkeintaan 255 merkki\xe4",style:{minHeight:50},value:e.text}),l.a.createElement(O,{error:e.error})),l.a.createElement(T.a,{content:"Tallenna",disabled:null!==e.error,fluid:!0}))},Se=function(e){return l.a.createElement(C.a.Item,{key:e.createdOn},l.a.createElement(C.a.Icon,{color:"grey",name:"comment outline",verticalAlign:"middle"}),l.a.createElement(C.a.Content,null,l.a.createElement(C.a.Header,{content:"".concat(x(e.createdOn)," \u2014 ").concat(e.owner.firstName," ").concat(e.owner.lastName)}),l.a.createElement(C.a.Description,{content:e.text})))},_e=function(e){var t=e.comments;return l.a.createElement(C.a,{divided:!0,relaxed:!0},t.length>0?t.sort(function(e,t){return Date.parse(e.createdOn)-Date.parse(t.createdOn)}).map(Se):l.a.createElement(Oe,null))},Ae={REQUEST_START:"COMMENT_START",REQUEST_OVER:"COMMENT_OVER"},De=function(e){function t(){var e;return Object(n.a)(this,t),(e=Object(r.a)(this,Object(c.a)(t).call(this))).handleChange=function(t,a){var n=a.value;t.preventDefault(),e.setState({text:n})},e.handleSubmit=function(t){t.preventDefault();var a=e.props,n=a.entity,r=a.id,c=a.thunk,o=a.token;(0,a.uploadComment)(r,{entity:n,id:r,text:e.state.text},o,c)},e.validateForm=function(){var t=e.state.text.trim();return 0===t.length?"Ei voi olla tyhj\xe4":t.length>255?"Korkeintaan 255 merkki\xe4":null},e.render=function(){return l.a.createElement("div",null,l.a.createElement(_e,{comments:e.props.comments}),l.a.createElement(z.a,null),l.a.createElement(we,{button:"Lis\xe4\xe4 huomio"},l.a.createElement(Ie,{error:e.validateForm(),onChange:e.handleChange,onSubmit:e.handleSubmit,pending:e.props.pending,text:e.state.text})))},e.state={text:""},e}return Object(o.a)(t,e),t}(l.a.Component),Ne=Object(S.b)(function(e){return{pending:e.comments.pending,token:e.auth.token}},{uploadComment:function(e,t,a,n){return function(){var e=Object(J.a)(Q.a.mark(function e(r){var c;return Q.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r({type:Ae.REQUEST_START}),e.prev=1,e.next=4,$.a.post("/api/comments",t,Z(a));case 4:r(n(a)),e.next=11;break;case 7:e.prev=7,e.t0=e.catch(1),c=X(e.t0),r(ae(c.message,"error"));case 11:r({type:Ae.REQUEST_OVER});case 12:case"end":return e.stop()}},e,null,[[1,7]])}));return function(t){return e.apply(this,arguments)}}()}})(De),xe=a(472),Fe=function(e){var t=e.message;return l.a.createElement(xe.a,{align:"center",error:!0,content:t||"Sivua/resurssia ei ole olemassa, \xe4l\xe4 pelleile osoitepalkin kanssa!",header:"Virhetilanne!"})},Pe={FETCH:"FETCH_MATERIALS",FETCH_OK:"FETCH_MATERIALS_OK",FETCH_ERROR:"FETCH_MATERIALS_ERROR",WRITE:"WRITE_MATERIAL",WRITE_ERROR:"WRITE_MATERIAL_ERROR",WRITE_INVALID:"WRITE_MATERIAL_INVALID",WRITE_RESET:"RESET_WRITE_MATERIAL",CREATED:"CREATE_MATERIAL_OK",UPDATED:"UPDATE_MATERIAL_OK"},Le=te(Pe),He=function(){return{type:Pe.WRITE_RESET}},We=function(e){return function(){var t=Object(J.a)(Q.a.mark(function t(a){var n,r;return Q.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return a(Le.fetch()),t.prev=1,t.next=4,$.a.get("/api/materials",Z(e));case 4:n=t.sent,a(Le.fetchOk(n.data)),t.next=12;break;case 8:t.prev=8,t.t0=t.catch(1),r=X(t.t0),a(Le.fetchError(r.message));case 12:case"end":return t.stop()}},t,null,[[1,8]])}));return function(e){return t.apply(this,arguments)}}()},Ke=function(e){return function(){var t=Object(J.a)(Q.a.mark(function t(a,n){return Q.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!ee(n(),"materials")){t.next=4;break}a(We(e)),t.next=5;break;case 4:return t.abrupt("return",Promise.resolve());case 5:case"end":return t.stop()}},t)}));return function(e,a){return t.apply(this,arguments)}}()},Ue=function(e,t,a){return function(){var n=Object(J.a)(Q.a.mark(function n(r){var c,o;return Q.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return r(Le.write()),n.prev=1,n.next=4,$.a.put("".concat("/api/materials","/").concat(e),t,Z(a));case 4:c=n.sent,r(He()),r(Le.updateOk(c.data)),r(ae("Materiaalitiedot p\xe4ivitetty","ok")),n.next=15;break;case 10:n.prev=10,n.t0=n.catch(1),(o=X(n.t0)).validation?r(Le.writeInvalid(o.validation)):r(Le.writeError()),r(ae(o.message,"error"));case 15:case"end":return n.stop()}},n,null,[[1,10]])}));return function(e){return n.apply(this,arguments)}}()},Me={FETCH:"FETCH_TASKS",FETCH_OK:"FETCH_TASKS_OK",FETCH_ERROR:"FETCH_TASKS_ERROR",WRITE:"WRITE_TASK",WRITE_ERROR:"WRITE_TASK_ERROR",WRITE_INVALID:"WRITE_TASK_INVALID",WRITE_RESET:"RESET_WRITE_TASK",CREATED:"CREATE_TASK_OK",UPDATED:"UPDATE_TASK_OK"},Ve=te(Me),qe=function(){return{type:Me.WRITE_RESET}},Ge=function(e){return function(){var t=Object(J.a)(Q.a.mark(function t(a){var n,r;return Q.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return a(Ve.fetch()),t.prev=1,t.next=4,$.a.get("/api/tasks",Z(e));case 4:n=t.sent,a(Ve.fetchOk(n.data)),t.next=12;break;case 8:t.prev=8,t.t0=t.catch(1),r=X(t.t0),a(Ve.fetchError(r.message));case 12:case"end":return t.stop()}},t,null,[[1,8]])}));return function(e){return t.apply(this,arguments)}}()},ze=function(e){return function(){var t=Object(J.a)(Q.a.mark(function t(a,n){return Q.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!ee(n(),"tasks")){t.next=4;break}a(Ge(e)),t.next=5;break;case 4:return t.abrupt("return",Promise.resolve());case 5:case"end":return t.stop()}},t)}));return function(e,a){return t.apply(this,arguments)}}()},Ye=function(e,t,a){return function(){var n=Object(J.a)(Q.a.mark(function n(r){var c,o;return Q.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return r(Ve.write()),n.prev=1,n.next=4,$.a.put("".concat("/api/tasks","/").concat(e),t,Z(a));case 4:c=n.sent,r(qe()),r(Ve.updateOk(c.data)),r(ae("Teht\xe4v\xe4n tiedot p\xe4ivitetty","ok")),n.next=15;break;case 10:n.prev=10,n.t0=n.catch(1),(o=X(n.t0)).validation?r(Ve.writeInvalid(o.validation)):r(Ve.writeError()),r(ae(o.message,"error"));case 15:case"end":return n.stop()}},n,null,[[1,10]])}));return function(e){return n.apply(this,arguments)}}()},Qe=function(e){function t(){var e,a;Object(n.a)(this,t);for(var o=arguments.length,i=new Array(o),u=0;u<o;u++)i[u]=arguments[u];return(a=Object(r.a)(this,(e=Object(c.a)(t)).call.apply(e,[this].concat(i)))).componentDidMount=function(){return a.props.refresh(a.props.token)},a.componentWillUnmount=function(){return a.props.reset()},a.render=function(){var e=a.props,t=e.activity,n=e.id,r=e.isNew,c=e.task;return r||t?r&&!c?l.a.createElement(Fe,{message:"Virheellinen teht\xe4v\xe4n tunniste, \xe4l\xe4 sooloile osoitepalkin kanssa!"}):l.a.createElement("div",null,l.a.createElement(f,{active:r,title:"Perustiedot"},l.a.createElement(me,{activity:t||{task:c},id:n,isNew:r,task:c||{}})),r?null:l.a.createElement("div",null,l.a.createElement(f,{active:t.attachments.length>0,title:"Liitteet"},l.a.createElement(Re,{attachments:t.attachments||[],entity:"Activity",id:n,thunk:ue})),l.a.createElement(f,{active:t.comments.length>0,title:"Huomiot"},l.a.createElement(Ne,{comments:t.comments||[],entity:"Activity",id:n,thunk:ie})))):l.a.createElement(Fe,null)},a}return Object(o.a)(t,e),t}(l.a.Component),Je=Object(S.b)(function(e,t){var a=t.match.params.id,n=L(t.location.search).id;return{activity:e.activities.data.items.find(function(e){return e.id===a}),id:a,isNew:"new"===a,task:e.tasks.data.items.find(function(e){return e.id===n}),token:e.auth.token}},function(e){return{refresh:function(t){e(Ke(t)),e(ze(t))},reset:function(){e(oe())}}})(Qe),Be=a(467),$e=function(){return l.a.createElement(Be.a,{active:!0,inline:"centered",size:"huge"})},Ze=function(e){function t(){var e,a;Object(n.a)(this,t);for(var o=arguments.length,i=new Array(o),u=0;u<o;u++)i[u]=arguments[u];return(a=Object(r.a)(this,(e=Object(c.a)(t)).call.apply(e,[this].concat(i)))).componentDidMount=function(){return a.props.refresh(a.props.token)},a.render=function(){var e=a.props,t=e.error,n=e.match;return e.pending?l.a.createElement($e,null):t?l.a.createElement(Fe,{message:t}):l.a.createElement("div",null,l.a.createElement("h2",{className:"padded"},"Suoritteet"),l.a.createElement(se.b,{component:Je,exact:!0,path:"".concat(n.path,"/:id")}))},a}return Object(o.a)(t,e),t}(l.a.Component),Xe=Object(S.b)(function(e){return{error:e.activities.data.error,pending:e.activities.data.pending,token:e.auth.token}},function(e){return{refresh:function(t){e(le(t))}}})(Ze),et=function(e){var t=e.errors,a=e.onChange,n=e.readOnly,r=e.state;return l.a.createElement("div",null,l.a.createElement(y.a.Field,{error:void 0!==t.legalEntity},l.a.createElement("label",null,"Toiminimi"),l.a.createElement(g.a,{name:"legalEntity",onChange:a,placeholder:"Firma Oy",readOnly:n,value:r.legalEntity}),l.a.createElement(O,{error:t.legalEntity})),l.a.createElement(y.a.Field,{error:void 0!==t.businessId},l.a.createElement("label",null,"Y-tunnus"),l.a.createElement(g.a,{name:"businessId",onChange:a,placeholder:"1234567-8",readOnly:n,value:r.businessId}),l.a.createElement(O,{error:t.businessId})),l.a.createElement(y.a.Field,{error:void 0!==t.domicile},l.a.createElement("label",null,"Kotipaikka"),l.a.createElement(g.a,{name:"domicile",onChange:a,placeholder:"Saumala",readOnly:n,value:r.domicile}),l.a.createElement(O,{error:t.domicile})))},tt={FETCH:"FETCH_CLIENTS",FETCH_OK:"FETCH_CLIENTS_OK",FETCH_ERROR:"FETCH_CLIENTS_ERROR",WRITE:"WRITE_CLIENT",WRITE_ERROR:"WRITE_CLIENT_ERROR",WRITE_INVALID:"WRITE_CLIENT_INVALID",WRITE_RESET:"RESET_WRITE_CLIENT",CREATED:"CREATE_CLIENT_OK",UPDATED:"UPDATE_CLIENT_OK"},at=te(tt),nt=function(){return{type:tt.WRITE_RESET}},rt=function(e){return function(){var t=Object(J.a)(Q.a.mark(function t(a){var n,r;return Q.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return a(at.fetch()),t.prev=1,t.next=4,$.a.get("/api/clients",Z(e));case 4:n=t.sent,a(at.fetchOk(n.data)),t.next=12;break;case 8:t.prev=8,t.t0=t.catch(1),r=X(t.t0),a(at.fetchError(r.message));case 12:case"end":return t.stop()}},t,null,[[1,8]])}));return function(e){return t.apply(this,arguments)}}()},ct=function(e){return function(){var t=Object(J.a)(Q.a.mark(function t(a,n){return Q.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!ee(n(),"clients")){t.next=4;break}a(rt(e)),t.next=5;break;case 4:return t.abrupt("return",Promise.resolve());case 5:case"end":return t.stop()}},t)}));return function(e,a){return t.apply(this,arguments)}}()},ot=function(e,t,a){return function(){var n=Object(J.a)(Q.a.mark(function n(r){var c,o;return Q.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return r(at.write()),n.prev=1,n.next=4,$.a.put("".concat("/api/clients","/").concat(e),t,Z(a));case 4:c=n.sent,r(nt()),r(at.updateOk(c.data)),r(ae("Asiakkaan tiedot p\xe4ivitetty","ok")),n.next=15;break;case 10:n.prev=10,n.t0=n.catch(1),(o=X(n.t0)).validation?r(at.writeInvalid(o.validation)):r(at.writeError()),r(ae(o.message,"error"));case 15:case"end":return n.stop()}},n,null,[[1,10]])}));return function(e){return n.apply(this,arguments)}}()},it=function(e){function t(e){var a;return Object(n.a)(this,t),(a=Object(r.a)(this,Object(c.a)(t).call(this,e))).handleChange=function(e,t){var n=t.name,r=t.value;return a.setState(Object(v.a)({},n,r))},a.handleSubmit=function(e){e.preventDefault();var t=a.props,n=t.history,r=t.id,c=t.isNew,o=t.token;a.props.save(a.state,n,r,c,o)},a.render=function(){return l.a.createElement(y.a,{loading:a.props.pending,onSubmit:a.handleSubmit},l.a.createElement(et,{errors:a.props.errors,onChange:a.handleChange,readOnly:a.props.readOnly,state:a.state}),l.a.createElement(z.a,{hidden:!0}),a.props.readOnly?null:l.a.createElement(T.a,{content:"Tallenna",fluid:!0}))},a.state=U(e.client),a}return Object(o.a)(t,e),t}(l.a.Component),lt=Object(se.f)(Object(S.b)(function(e){return{errors:e.clients.write.errors,pending:e.clients.write.pending,readOnly:!e.auth.admin,token:e.auth.token}},function(e){return{save:function(t,a,n,r,c){e(r?function(e,t,a){return function(){var n=Object(J.a)(Q.a.mark(function n(r){var c,o;return Q.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return r(at.write()),n.prev=1,n.next=4,$.a.post("/api/clients",e,Z(t));case 4:c=n.sent,r(nt()),r(at.createOk(c.data)),r(ae("Uusi asiakas lis\xe4tty","ok")),a.replace("/clients/".concat(c.data.id)),n.next=16;break;case 11:n.prev=11,n.t0=n.catch(1),(o=X(n.t0)).validation?r(at.writeInvalid(o.validation)):r(at.writeError()),r(ae(o.message,"error"));case 16:case"end":return n.stop()}},n,null,[[1,11]])}));return function(e){return n.apply(this,arguments)}}()}(t,c,a):ot(n,t,c))}}})(it)),ut=function(e){var t=e.entities,a=e.toRow;return l.a.createElement(C.a,{divided:!0,relaxed:!0},t.length>0?t.map(a):l.a.createElement(Oe,null))},st=function(e){var t=e.onChange,a=e.value;return l.a.createElement(g.a,{fluid:!0,icon:"search",onChange:t,placeholder:"Kirjoita hakusana",value:a})},dt=function(e){function t(){var e;return Object(n.a)(this,t),(e=Object(r.a)(this,Object(c.a)(t).call(this))).handleChange=function(t,a){var n=a.value;return e.setState({filter:n.toLowerCase()})},e.render=function(){return l.a.createElement("div",null,l.a.createElement(st,{onChange:e.handleChange,value:e.state.filter}),l.a.createElement(ut,{entities:e.props.filter(e.props.entities,e.state.filter),toRow:e.props.toRow}))},e.state={filter:""},e}return Object(o.a)(t,e),t}(l.a.Component),mt=dt,pt={FETCH:"FETCH_PROJECTS",FETCH_OK:"FETCH_PROJECTS_OK",FETCH_ERROR:"FETCH_PROJECTS_ERROR",WRITE:"WRITE_PROJECT",WRITE_ERROR:"WRITE_PROJECT_ERROR",WRITE_INVALID:"WRITE_PROJECT_INVALID",WRITE_RESET:"RESET_WRITE_PROJECT",CREATED:"CREATE_PROJECT_OK",UPDATED:"UPDATE_PROJECT_OK",ASSIGNED:"ASSIGN_EMPLOYEE_OK"},Et=te(pt),ft=function(e,t){return{type:pt.ASSIGNED,payload:{project:e,employee:t}}},ht=function(){return{type:pt.WRITE_RESET}},vt=function(e){return function(){var t=Object(J.a)(Q.a.mark(function t(a){var n,r;return Q.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return a(Et.fetch()),t.prev=1,t.next=4,$.a.get("/api/projects",Z(e));case 4:n=t.sent,a(Et.fetchOk(n.data)),t.next=12;break;case 8:t.prev=8,t.t0=t.catch(1),r=X(t.t0),a(Et.fetchError(r.message));case 12:case"end":return t.stop()}},t,null,[[1,8]])}));return function(e){return t.apply(this,arguments)}}()},bt=function(e){return function(){var t=Object(J.a)(Q.a.mark(function t(a,n){return Q.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!ee(n(),"projects")){t.next=4;break}a(vt(e)),t.next=5;break;case 4:return t.abrupt("return",Promise.resolve());case 5:case"end":return t.stop()}},t)}));return function(e,a){return t.apply(this,arguments)}}()},Ot=function(e,t,a){return function(){var n=Object(J.a)(Q.a.mark(function n(r){var c,o;return Q.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return r(Et.write()),n.prev=1,n.next=4,$.a.put("".concat("/api/projects","/").concat(e),t,Z(a));case 4:c=n.sent,r(ht()),r(Et.updateOk(c.data)),r(ae("Ty\xf6maan tiedot p\xe4ivitetty","ok")),n.next=15;break;case 10:n.prev=10,n.t0=n.catch(1),(o=X(n.t0)).validation?r(Et.writeInvalid(o.validation)):r(Et.writeError()),r(ae(o.message,"error"));case 15:case"end":return n.stop()}},n,null,[[1,10]])}));return function(e){return n.apply(this,arguments)}}()},yt=function(e,t){return e.filter(function(e){var a=H(e.description),n="".concat(x(e.date)," \u2014 ").concat(e.owner.lastName,", ").concat(e.owner.firstName);return a.toLowerCase().includes(t)||n.toLowerCase().includes(t)}).sort(function(e,t){var a="".concat(x(e.date)," \u2014 ").concat(e.owner.lastName,", ").concat(e.owner.firstName),n="".concat(x(t.date)," \u2014 ").concat(t.owner.lastName,", ").concat(t.owner.firstName);return a.localeCompare(n)})},gt=function(e,t){return e.filter(function(e){var a="".concat(e.project.projectId," \u2014 ").concat(e.task.name),n="".concat(x(e.date)," \u2014 ").concat(e.hours," tuntia");return a.toLowerCase().includes(t)||n.toLowerCase().includes(t)}).sort(function(e,t){if(x(e.date)!==x(t.date))return Date.parse(t.date)-Date.parse(e.date);var a="".concat(e.project.projectId," \u2014 ").concat(e.task.name),n="".concat(t.project.projectId," \u2014 ").concat(t.task.name);return a.localeCompare(n)})},kt=function(e,t){return e.filter(function(e){return e.businessId.toLowerCase().includes(t)||e.legalEntity.toLowerCase().includes(t)}).sort(function(e,t){return e.legalEntity.localeCompare(t.legalEntity)})},jt=function(e,t){return e.filter(function(e){return"".concat(e.lastName,", ").concat(e.firstName).toLowerCase().includes(t)}).sort(function(e,t){return e.lastName.localeCompare(t.lastName)})},wt=function(e,t){return e.filter(function(e){return e.name.toLowerCase().includes(t)}).sort(function(e,t){return e.name.localeCompare(t.name)})},Ct=function(e,t){return e.filter(function(e){return e.name.toLowerCase().includes(t)||e.projectId.toLowerCase().includes(t)||e.client.legalEntity.toLowerCase().includes(t)}).sort(function(e,t){return e.projectId.localeCompare(t.projectId)})},Tt=function(e,t){return e.filter(function(e){var a="".concat(x(e.startDate)," \u2014 ").concat(x(e.endDate)),n="".concat(e.projectId," \u2014 ").concat(e.name);return a.toLowerCase().includes(t)||n.toLowerCase().includes(t)}).sort(function(e,t){return e.projectId.localeCompare(t.projectId)})},Rt=function(e,t){return e.filter(function(e){var a="".concat(x(e.startDate)," \u2014 ").concat(x(e.endDate)),n="".concat(e.project.projectId," \u2014 ").concat(e.name);return a.toLowerCase().includes(t)||n.toLowerCase().includes(t)}).sort(function(e,t){var a="".concat(e.project.projectId,"_").concat(e.name),n="".concat(t.project.projectId,"_").concat(t.name);return a.localeCompare(n)})},It=function(e,t){return e.filter(function(e){return e.name.toLowerCase().includes(t)||"".concat(x(e.startDate)," \u2014 ").concat(x(e.endDate)).toLowerCase().includes(t)}).sort(function(e,t){return Date.parse(t.startDate)-Date.parse(e.startDate)})},St=function(e){return l.a.createElement(C.a.Item,{as:ye.b,key:e.id,to:"/activities/".concat(e.id)},l.a.createElement(C.a.Icon,{color:"grey",name:e.signed?"check circle outline":"circle outline",verticalAlign:"middle"}),l.a.createElement(C.a.Content,null,l.a.createElement(C.a.Header,{content:"".concat(x(e.date)," \u2014 ").concat(e.owner.lastName,", ").concat(e.owner.firstName," (").concat(e.hours," tuntia)")}),l.a.createElement(C.a.Description,{content:H(e.description)})))},_t=function(e){return l.a.createElement(C.a.Item,{as:ye.b,key:e.id,to:"/activities/".concat(e.id)},l.a.createElement(C.a.Icon,{color:"grey",name:e.signed?"check circle outline":"circle outline",verticalAlign:"middle"}),l.a.createElement(C.a.Content,null,l.a.createElement(C.a.Header,{content:"".concat(x(e.date)," \u2014 ").concat(e.hours," tuntia")}),l.a.createElement(C.a.Description,{content:"".concat(e.project.projectId," \u2014 ").concat(e.task.name)})))},At=function(e){return l.a.createElement(C.a.Item,{as:ye.b,key:e.id,to:"/clients/".concat(e.id)},l.a.createElement(C.a.Icon,{color:"grey",name:"suitcase",verticalAlign:"middle"}),l.a.createElement(C.a.Content,null,l.a.createElement(C.a.Header,{content:e.legalEntity}),l.a.createElement(C.a.Description,{content:e.businessId})))},Dt=function(e){return l.a.createElement(C.a.Item,{as:ye.b,key:e.id,to:"/employees/".concat(e.id)},l.a.createElement(C.a.Icon,{color:"grey",name:e.enabled?"check":"ban",verticalAlign:"middle"}),l.a.createElement(C.a.Content,null,l.a.createElement(C.a.Header,{content:"".concat(e.lastName,", ").concat(e.firstName)}),l.a.createElement(C.a.Description,{content:e.administrator?"Ty\xf6njohtaja":"Ty\xf6ntekij\xe4"})))},Nt=function(e){return l.a.createElement(C.a.Item,{as:ye.b,key:e.id,to:"/materials/".concat(e.id)},l.a.createElement(C.a.Icon,{color:"grey",name:"cube",verticalAlign:"middle"}),l.a.createElement(C.a.Content,null,l.a.createElement(C.a.Header,{content:e.name}),l.a.createElement(C.a.Description,{content:"".concat(e.unitCost,"\u20ac / ").concat(e.unit)})))},xt=function(e){return l.a.createElement(C.a.Item,{as:ye.b,key:e.id,to:"/projects/".concat(e.id)},l.a.createElement(C.a.Icon,{color:"grey",name:"industry",verticalAlign:"middle"}),l.a.createElement(C.a.Content,null,l.a.createElement(C.a.Header,{content:"".concat(e.projectId," \u2014 ").concat(e.name)}),l.a.createElement(C.a.Description,{content:e.client.legalEntity})))},Ft=function(e){return l.a.createElement(C.a.Item,{as:ye.b,key:e.id,to:"/projects/".concat(e.id)},l.a.createElement(C.a.Icon,{color:"grey",name:"industry",verticalAlign:"middle"}),l.a.createElement(C.a.Content,null,l.a.createElement(C.a.Header,{content:"".concat(e.projectId," \u2014 ").concat(e.name)}),l.a.createElement(C.a.Description,{content:"".concat(x(e.startDate)," \u2014 ").concat(x(e.endDate))})))},Pt=function(e){return l.a.createElement(C.a.Item,{as:ye.b,key:e.id,to:"/tasks/".concat(e.id)},l.a.createElement(C.a.Icon,{color:"grey",name:e.completed?"check circle outline":"circle outline",verticalAlign:"middle"}),l.a.createElement(C.a.Content,null,l.a.createElement(C.a.Header,{content:"".concat(e.project.projectId," \u2014 ").concat(e.name)}),l.a.createElement(C.a.Description,{content:"".concat(x(e.startDate)," \u2014 ").concat(x(e.endDate))})))},Lt=function(e){return l.a.createElement(C.a.Item,{as:ye.b,key:e.id,to:"/tasks/".concat(e.id)},l.a.createElement(C.a.Icon,{color:"grey",name:e.completed?"check circle outline":"circle outline",verticalAlign:"middle"}),l.a.createElement(C.a.Content,null,l.a.createElement(C.a.Header,{content:"".concat(e.name," (").concat(e.daysNeeded," ty\xf6p\xe4iv\xe4\xe4)")}),l.a.createElement(C.a.Description,{content:"".concat(x(e.startDate)," \u2014 ").concat(x(e.endDate))})))},Ht=function(e){function t(){var e,a;Object(n.a)(this,t);for(var o=arguments.length,i=new Array(o),u=0;u<o;u++)i[u]=arguments[u];return(a=Object(r.a)(this,(e=Object(c.a)(t)).call.apply(e,[this].concat(i)))).componentDidMount=function(){return a.props.refresh(a.props.token)},a.componentWillUnmount=function(){return a.props.reset()},a.render=function(){var e=a.props,t=e.client,n=e.id,r=e.isNew;return r||t?l.a.createElement("div",null,l.a.createElement(f,{active:r,title:"Perustiedot"},l.a.createElement(lt,{client:t||{},id:n,isNew:r})),r?null:l.a.createElement("div",null,l.a.createElement(f,{active:a.props.projects.length>0,title:"Asiakkaan ty\xf6maat"},l.a.createElement(mt,{entities:a.props.projects,filter:Tt,toRow:Ft})),l.a.createElement(f,{active:t.attachments.length>0,title:"Liitteet"},l.a.createElement(Re,{attachments:t.attachments||[],entity:"Client",id:n,thunk:ot})),l.a.createElement(f,{active:t.comments.length>0,title:"Huomiot"},l.a.createElement(Ne,{comments:t.comments||[],entity:"Client",id:n,thunk:rt})))):l.a.createElement(Fe,null)},a}return Object(o.a)(t,e),t}(l.a.Component),Wt=Object(S.b)(function(e,t){var a=t.match.params.id;return{client:e.clients.data.items.find(function(e){return e.id===a}),id:a,isNew:"new"===a,projects:e.projects.data.items.filter(function(e){return e.client.id===a}),token:e.auth.token}},function(e){return{refresh:function(t){e(bt(t))},reset:function(){e(nt())}}})(Ht),Kt=function(e){var t=e.active,a=e.href,n=e.label;return t?l.a.createElement("div",null,l.a.createElement(z.a,null),l.a.createElement(T.a,{as:ye.b,content:n,fluid:!0,to:a})):null},Ut=Object(S.b)(function(e){return{admin:e.auth.admin,clients:e.clients.data.items}},null)(function(e){var t=e.admin,a=e.clients;return l.a.createElement("div",null,l.a.createElement(mt,{entities:a,filter:kt,toRow:At}),l.a.createElement(Kt,{active:t,href:"/clients/new",label:"Lis\xe4\xe4 uusi asiakas"}))}),Mt=function(e){function t(){var e,a;Object(n.a)(this,t);for(var o=arguments.length,i=new Array(o),u=0;u<o;u++)i[u]=arguments[u];return(a=Object(r.a)(this,(e=Object(c.a)(t)).call.apply(e,[this].concat(i)))).componentDidMount=function(){return a.props.refresh(a.props.token)},a.render=function(){var e=a.props,t=e.error,n=e.match;return e.pending?l.a.createElement($e,null):t?l.a.createElement(Fe,{message:t}):l.a.createElement("div",null,l.a.createElement("h2",{className:"padded"},"Asiakkaat"),l.a.createElement(se.b,{component:Wt,exact:!0,path:"".concat(n.path,"/:id")}),l.a.createElement(se.b,{component:Ut,exact:!0,path:n.path}))},a}return Object(o.a)(t,e),t}(l.a.Component),Vt=Object(S.b)(function(e){return{error:e.clients.data.error,pending:e.clients.data.pending,token:e.auth.token}},function(e){return{refresh:function(t){e(ct(t))}}})(Mt),qt=function(e){var t=e.errors,a=e.onChange,n=e.readOnly,r=e.state;return l.a.createElement("div",null,l.a.createElement(y.a.Field,{error:void 0!==t["address.street"]},l.a.createElement("label",null,"Osoite"),l.a.createElement(g.a,{name:"street",onChange:a,placeholder:"Saumakuja 313",readOnly:n,value:r.street})),l.a.createElement(y.a.Field,{error:void 0!==t["address.street"]},l.a.createElement(g.a,{name:"streetExt",onChange:a,readOnly:n,value:r.streetExt}),l.a.createElement(O,{error:t["address.street"]})),l.a.createElement(y.a.Field,{error:void 0!==t["address.zipCode"]},l.a.createElement("label",null,"Postinumero"),l.a.createElement(g.a,{name:"zipCode",onChange:a,placeholder:"01300",readOnly:n,value:r.zipCode}),l.a.createElement(O,{error:t["address.zipCode"]})),l.a.createElement(y.a.Field,{error:void 0!==t["address.city"]},l.a.createElement("label",null,"Kaupunki"),l.a.createElement(g.a,{name:"city",onChange:a,placeholder:"Saumala",readOnly:n,value:r.city}),l.a.createElement(O,{error:t["address.city"]})),l.a.createElement(y.a.Field,{error:void 0!==t["address.country"]},l.a.createElement("label",null,"Valtio"),l.a.createElement(g.a,{name:"country",onChange:a,placeholder:"Suomi",readOnly:n,value:r.country}),l.a.createElement(O,{error:t["address.country"]})))},Gt=function(e){function t(e){var a;return Object(n.a)(this,t),(a=Object(r.a)(this,Object(c.a)(t).call(this,e))).handleChange=function(e,t){var n=t.name,r=t.value,c=Object(h.a)({},a.state,Object(v.a)({},n,r));a.setState(c),a.props.sync(c)},a.render=function(){return l.a.createElement(qt,{errors:a.props.errors,onChange:a.handleChange,readOnly:a.props.readOnly,state:a.state})},a.state=e.address,a}return Object(o.a)(t,e),t}(l.a.Component),zt=function(e){var t=e.errors,a=e.onChange,n=e.readOnly,r=e.state;return l.a.createElement("div",null,l.a.createElement(y.a.Field,{error:void 0!==t.username},l.a.createElement("label",null,"K\xe4ytt\xe4j\xe4tunnus"),l.a.createElement(g.a,{name:"username",onChange:a,placeholder:"T\xe4ll\xe4 kirjaudutaan sis\xe4\xe4n",readOnly:n,value:r.username}),l.a.createElement(O,{error:t.username})),l.a.createElement(y.a.Field,{error:void 0!==t.firstName},l.a.createElement("label",null,"Etunimi"),l.a.createElement(g.a,{name:"firstName",onChange:a,placeholder:"Paavo",readOnly:n,value:r.firstName}),l.a.createElement(O,{error:t.firstName})),l.a.createElement(y.a.Field,{error:void 0!==t.lastName},l.a.createElement("label",null,"Sukunimi"),l.a.createElement(g.a,{name:"lastName",onChange:a,placeholder:"Pesusieni",readOnly:n,value:r.lastName}),l.a.createElement(O,{error:t.lastName})),l.a.createElement(y.a.Field,{error:void 0!==t.phone},l.a.createElement("label",null,"Puhelin"),l.a.createElement(g.a,{name:"phone",onChange:a,placeholder:"040-123-4567",readOnly:n,value:r.phone}),l.a.createElement(O,{error:t.phone})),l.a.createElement(y.a.Field,{error:void 0!==t.email},l.a.createElement("label",null,"Email"),l.a.createElement(g.a,{name:"email",onChange:a,placeholder:"paavo@firma.io",readOnly:n,value:r.email}),l.a.createElement(O,{error:t.email})))},Yt={FETCH:"FETCH_EMPLOYEES",FETCH_OK:"FETCH_EMPLOYEES_OK",FETCH_ERROR:"FETCH_EMPLOYEES_ERROR",WRITE:"WRITE_EMPLOYEE",WRITE_ERROR:"WRITE_EMPLOYEE_ERROR",WRITE_INVALID:"WRITE_EMPLOYEE_INVALID",WRITE_RESET:"RESET_WRITE_EMPLOYEE",CREATED:"CREATE_EMPLOYEE_OK",UPDATED:"UPDATE_EMPLOYEE_OK",ASSIGNED:"ASSIGN_EMPLOYEE_OK"},Qt=te(Yt),Jt=function(){return{type:Yt.WRITE_RESET}},Bt=function(e){return function(){var t=Object(J.a)(Q.a.mark(function t(a){var n,r;return Q.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return a(Qt.fetch()),t.prev=1,t.next=4,$.a.get("/api/employees",Z(e));case 4:n=t.sent,a(Qt.fetchOk(n.data)),t.next=12;break;case 8:t.prev=8,t.t0=t.catch(1),r=X(t.t0),a(Qt.fetchError(r.message));case 12:case"end":return t.stop()}},t,null,[[1,8]])}));return function(e){return t.apply(this,arguments)}}()},$t=function(e){return function(){var t=Object(J.a)(Q.a.mark(function t(a,n){return Q.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!ee(n(),"employees")){t.next=4;break}a(Bt(e)),t.next=5;break;case 4:return t.abrupt("return",Promise.resolve());case 5:case"end":return t.stop()}},t)}));return function(e,a){return t.apply(this,arguments)}}()},Zt=function(e,t,a){return function(){var n=Object(J.a)(Q.a.mark(function n(r){var c,o;return Q.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return r(Qt.write()),n.prev=1,n.next=4,$.a.put("".concat("/api/employees","/").concat(e),t,Z(a));case 4:c=n.sent,r(Jt()),r(Qt.updateOk(c.data)),r(ae("Ty\xf6ntekij\xe4n tiedot p\xe4ivitetty","ok")),n.next=15;break;case 10:n.prev=10,n.t0=n.catch(1),(o=X(n.t0)).validation?r(Qt.writeInvalid(o.validation)):r(Qt.writeError()),r(ae(o.message,"error"));case 15:case"end":return n.stop()}},n,null,[[1,10]])}));return function(e){return n.apply(this,arguments)}}()},Xt=function(e){function t(e){var a;return Object(n.a)(this,t),(a=Object(r.a)(this,Object(c.a)(t).call(this,e))).handleChange=function(e,t){var n="checkbox"===t.type?t.checked:t.value;a.setState(Object(v.a)({},t.name,n))},a.handleSubmit=function(e){e.preventDefault();var t=a.props,n=t.history,r=t.id,c=t.isNew,o=t.token;a.props.save(a.state,n,r,c,o)},a.syncAddressState=function(e){return a.setState(Object(h.a)({},a.state,{address:e}))},a.render=function(){return l.a.createElement(y.a,{loading:a.props.pending,onSubmit:a.handleSubmit},l.a.createElement(zt,{errors:a.props.errors,onChange:a.handleChange,readOnly:a.props.readOnly,state:a.state}),l.a.createElement(z.a,{hidden:!0}),l.a.createElement(Gt,{address:a.state.address,errors:a.props.errors,readOnly:a.props.readOnly,sync:a.syncAddressState}),l.a.createElement(z.a,{hidden:!0}),l.a.createElement(y.a.Group,{widths:"equal"},l.a.createElement(y.a.Checkbox,{checked:a.state.administrator,label:"Ty\xf6njohtaja",name:"administrator",onChange:a.handleChange,readOnly:a.props.readOnly}),l.a.createElement(y.a.Checkbox,{checked:a.state.enabled,label:"K\xe4ytt\xf6oikeudet",name:"enabled",onChange:a.handleChange,readOnly:a.props.readOnly})),l.a.createElement(z.a,{hidden:!0}),a.props.readOnly?null:l.a.createElement(T.a,{content:"Tallenna",fluid:!0}))},a.state=M(e.employee),a}return Object(o.a)(t,e),t}(l.a.Component),ea=Object(se.f)(Object(S.b)(function(e){return{errors:e.employees.write.errors,pending:e.employees.write.pending,readOnly:!e.auth.admin,token:e.auth.token}},function(e){return{save:function(t,a,n,r,c){e(r?function(e,t,a){return function(){var n=Object(J.a)(Q.a.mark(function n(r){var c,o;return Q.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return r(Qt.write()),n.prev=1,n.next=4,$.a.post("/api/employees",e,Z(t));case 4:c=n.sent,r(Jt()),r(Qt.createOk(c.data)),r(ae("Uusi ty\xf6ntekij\xe4 lis\xe4tty","ok")),a.replace("/employees/".concat(c.data.id)),n.next=16;break;case 11:n.prev=11,n.t0=n.catch(1),(o=X(n.t0)).validation?r(Qt.writeInvalid(o.validation)):r(Qt.writeError()),r(ae(o.message,"error"));case 16:case"end":return n.stop()}},n,null,[[1,11]])}));return function(e){return n.apply(this,arguments)}}()}(t,c,a):Zt(n,t,c))}}})(Xt)),ta=function(e){function t(){var e,a;Object(n.a)(this,t);for(var o=arguments.length,i=new Array(o),u=0;u<o;u++)i[u]=arguments[u];return(a=Object(r.a)(this,(e=Object(c.a)(t)).call.apply(e,[this].concat(i)))).componentDidMount=function(){return a.props.refresh(a.props.token)},a.componentWillUnmount=function(){return a.props.reset()},a.render=function(){var e=a.props,t=e.employee,n=e.isNew;return n||t?l.a.createElement("div",null,l.a.createElement(f,{active:n,title:"Perustiedot"},l.a.createElement(ea,{employee:t||{},id:a.props.id,isNew:n})),n?null:l.a.createElement("div",null,l.a.createElement(f,{active:t.projects.length>0,title:"Ty\xf6maat"},l.a.createElement(mt,{entities:a.props.projects,filter:Ct,toRow:xt})),l.a.createElement(f,{active:a.props.activities.length>0,title:"Suoritteet"},l.a.createElement(mt,{entities:a.props.activities,filter:gt,toRow:_t})))):l.a.createElement(Fe,null)},a}return Object(o.a)(t,e),t}(l.a.Component),aa=Object(S.b)(function(e,t){var a=t.match.params.id;return{activities:e.activities.data.items.filter(function(e){return e.owner.id===a}),employee:e.employees.data.items.find(function(e){return e.id===a}),id:a,isNew:"new"===a,projects:e.projects.data.items.filter(function(e){return e.employees.includes(a)}),token:e.auth.token}},function(e){return{refresh:function(t){e(le(t)),e(bt(t))},reset:function(){e(Jt())}}})(ta),na=Object(S.b)(function(e){return{admin:e.auth.admin,employees:e.employees.data.items}},null)(function(e){var t=e.admin,a=e.employees;return l.a.createElement("div",null,l.a.createElement(mt,{entities:a,filter:jt,toRow:Dt}),l.a.createElement(Kt,{active:t,href:"/employees/new",label:"Lis\xe4\xe4 uusi henkil\xf6"}))}),ra=function(e){function t(){var e,a;Object(n.a)(this,t);for(var o=arguments.length,i=new Array(o),u=0;u<o;u++)i[u]=arguments[u];return(a=Object(r.a)(this,(e=Object(c.a)(t)).call.apply(e,[this].concat(i)))).componentDidMount=function(){return a.props.refresh(a.props.token)},a.render=function(){var e=a.props,t=e.error,n=e.match;return e.pending?l.a.createElement($e,null):t?l.a.createElement(Fe,{message:t}):l.a.createElement("div",null,l.a.createElement("h2",{className:"padded"},"Henkil\xf6st\xf6"),l.a.createElement(se.b,{component:aa,exact:!0,path:"".concat(n.path,"/:id")}),l.a.createElement(se.b,{component:na,exact:!0,path:n.path}))},a}return Object(o.a)(t,e),t}(l.a.Component),ca=Object(S.b)(function(e){return{error:e.employees.data.error,pending:e.employees.data.pending,token:e.auth.token}},function(e){return{refresh:function(t){e($t(t))}}})(ra),oa=function(e){var t=e.errors,a=e.onChange,n=e.readOnly,r=e.state;return l.a.createElement("div",null,l.a.createElement(y.a.Field,{error:void 0!==t.name},l.a.createElement("label",null,"Nimike"),l.a.createElement(g.a,{name:"name",onChange:a,placeholder:"Esim. tuotenimi ja saumaleveys",readOnly:n,value:r.name}),l.a.createElement(O,{error:t.name})),l.a.createElement(y.a.Field,{error:void 0!==t.unit},l.a.createElement("label",null,"Mittayksikk\xf6"),l.a.createElement(g.a,{name:"unit",onChange:a,placeholder:"m / m\xb3 / kpl ...",readOnly:n,value:r.unit}),l.a.createElement(O,{error:t.unit})),l.a.createElement(y.a.Field,{error:void 0!==t.unitCost},l.a.createElement("label",null,"Yksikk\xf6kustannus"),l.a.createElement(g.a,{icon:"eur",iconPosition:"left",name:"unitCost",onChange:a,placeholder:"13.37",readOnly:n,value:r.unitCost}),l.a.createElement(O,{error:t.unitCost})))},ia=function(e){function t(e){var a;return Object(n.a)(this,t),(a=Object(r.a)(this,Object(c.a)(t).call(this,e))).handleChange=function(e,t){var n=t.name,r=t.value;return a.setState(Object(v.a)({},n,r))},a.handleSubmit=function(e){e.preventDefault();var t=a.props,n=t.history,r=t.id,c=t.isNew,o=t.token;a.props.save(a.state,n,r,c,o)},a.render=function(){return l.a.createElement(y.a,{loading:a.props.pending,onSubmit:a.handleSubmit},l.a.createElement(oa,{errors:a.props.errors,onChange:a.handleChange,readOnly:a.props.readOnly,state:a.state}),l.a.createElement(z.a,{hidden:!0}),a.props.readOnly?null:l.a.createElement(T.a,{content:"Tallenna",fluid:!0}))},a.state=V(e.material),a}return Object(o.a)(t,e),t}(l.a.Component),la=Object(se.f)(Object(S.b)(function(e){return{errors:e.materials.write.errors,pending:e.materials.write.pending,readOnly:!e.auth.admin,token:e.auth.token}},function(e){return{save:function(t,a,n,r,c){var o=Object(h.a)({},t,{unitCost:F(t.unitCost)});return e(r?function(e,t,a){return function(){var n=Object(J.a)(Q.a.mark(function n(r){var c,o;return Q.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return r(Le.write()),n.prev=1,n.next=4,$.a.post("/api/materials",e,Z(t));case 4:c=n.sent,r(He()),r(Le.createOk(c.data)),r(ae("Materiaali lis\xe4tty","ok")),a.replace("/materials/".concat(c.data.id)),n.next=16;break;case 11:n.prev=11,n.t0=n.catch(1),(o=X(n.t0)).validation?r(Le.writeInvalid(o.validation)):r(Le.writeError()),r(ae(o.message,"error"));case 16:case"end":return n.stop()}},n,null,[[1,11]])}));return function(e){return n.apply(this,arguments)}}()}(o,c,a):Ue(n,o,c))}}})(ia)),ua=function(e){function t(){var e,a;Object(n.a)(this,t);for(var o=arguments.length,i=new Array(o),u=0;u<o;u++)i[u]=arguments[u];return(a=Object(r.a)(this,(e=Object(c.a)(t)).call.apply(e,[this].concat(i)))).componentWillUnmount=function(){return a.props.reset()},a.render=function(){var e=a.props,t=e.id,n=e.isNew,r=e.material;return n||r?l.a.createElement("div",null,l.a.createElement(f,{active:n,title:"Perustiedot"},l.a.createElement(la,{id:t,isNew:n,material:r||{}})),n?null:l.a.createElement("div",null,l.a.createElement(f,{active:r.attachments.length>0,title:"Liitteet"},l.a.createElement(Re,{attachments:r.attachments||[],entity:"Material",id:t,thunk:Ue})),l.a.createElement(f,{active:r.comments.length>0,title:"Huomiot"},l.a.createElement(Ne,{comments:r.comments||[],entity:"Material",id:t,thunk:We})))):l.a.createElement(Fe,null)},a}return Object(o.a)(t,e),t}(l.a.Component),sa=Object(S.b)(function(e,t){var a=t.match.params.id;return{id:a,isNew:"new"===a,material:e.materials.data.items.find(function(e){return e.id===a})}},function(e){return{reset:function(){e(He())}}})(ua),da=Object(S.b)(function(e){return{admin:e.auth.admin,materials:e.materials.data.items}},null)(function(e){var t=e.admin,a=e.materials;return l.a.createElement("div",null,l.a.createElement(mt,{entities:a,filter:wt,toRow:Nt}),l.a.createElement(Kt,{active:t,href:"/materials/new",label:"Lis\xe4\xe4 uusi materiaali"}))}),ma=function(e){function t(){var e,a;Object(n.a)(this,t);for(var o=arguments.length,i=new Array(o),u=0;u<o;u++)i[u]=arguments[u];return(a=Object(r.a)(this,(e=Object(c.a)(t)).call.apply(e,[this].concat(i)))).componentDidMount=function(){return a.props.refresh(a.props.token)},a.render=function(){var e=a.props,t=e.error,n=e.match;return e.pending?l.a.createElement($e,null):t?l.a.createElement(Fe,{message:t}):l.a.createElement("div",null,l.a.createElement("h2",{className:"padded"},"Materiaalit"),l.a.createElement(se.b,{component:sa,exact:!0,path:"".concat(n.path,"/:id")}),l.a.createElement(se.b,{exact:!0,path:n.path,component:da}))},a}return Object(o.a)(t,e),t}(l.a.Component),pa=Object(S.b)(function(e){return{error:e.materials.data.error,pending:e.materials.data.pending,token:e.auth.token}},function(e){return{refresh:function(t){e(Ke(t))}}})(ma),Ea=function(e){var t=M(e);return delete t.administrator,delete t.enabled,t},fa=function(e){function t(e){var a;return Object(n.a)(this,t),(a=Object(r.a)(this,Object(c.a)(t).call(this,e))).handleChange=function(e,t){var n=t.name,r=t.value;return a.setState(Object(v.a)({},n,r))},a.handleSubmit=function(e){e.preventDefault();var t=a.props.auth,n=t.id,r=t.token;a.props.updateEmployee(n,a.state,r)},a.syncAddressState=function(e){return a.setState(Object(h.a)({},a.state,{address:e}))},a.render=function(){return l.a.createElement(y.a,{loading:a.props.pending,onSubmit:a.handleSubmit},l.a.createElement(zt,{errors:a.props.errors,onChange:a.handleChange,readOnly:!1,state:a.state}),l.a.createElement(z.a,{hidden:!0}),l.a.createElement(Gt,{address:a.state.address,errors:a.props.errors,readOnly:!1,sync:a.syncAddressState}),l.a.createElement(z.a,{hidden:!0}),l.a.createElement(T.a,{content:"Tallenna",fluid:!0}))},a.state=Ea(e.employee),a}return Object(o.a)(t,e),t}(l.a.Component),ha=Object(S.b)(function(e){return{auth:e.auth,errors:e.employees.write.errors,pending:e.employees.write.pending}},{updateEmployee:Zt})(fa),va=function(){return l.a.createElement(C.a,{bulleted:!0},l.a.createElement(C.a.Item,{content:"V\xe4hint\xe4\xe4n 8 merkki\xe4"}),l.a.createElement(C.a.Item,{content:"V\xe4hint\xe4\xe4n yksi iso kirjain A-Z"}),l.a.createElement(C.a.Item,{content:"V\xe4hint\xe4\xe4n yksi pieni kirjain a-z"}),l.a.createElement(C.a.Item,{content:"V\xe4hint\xe4\xe4n yksi numero 0-9"}),l.a.createElement(C.a.Item,{content:"Sallitut erikoismerkit: ! # $ % & ' * + . : , ; / = ? @ ^ _ ~ -"}))},ba=a(476),Oa=function(e){return l.a.createElement(ba.a,{content:l.a.createElement(va,null),header:"Vaatimukset",on:"focus",trigger:e})},ya=function(e){var t=e.errors,a=e.onChange,n=e.state;return l.a.createElement("div",null,l.a.createElement(y.a.Field,{error:void 0!==t.password},l.a.createElement("label",null,"Nykyinen salasana"),l.a.createElement(g.a,{name:"password",onChange:a,placeholder:"qwerty",type:"password",value:n.password}),l.a.createElement(O,{error:t.password})),l.a.createElement(y.a.Field,{error:void 0!==t.newPassword},l.a.createElement("label",null,"Uusi salasana"),Oa(l.a.createElement(g.a,{name:"newPassword",onChange:a,placeholder:"trustno1",type:"password",value:n.newPassword}))),l.a.createElement(y.a.Field,{error:void 0!==t.newPassword},l.a.createElement("label",null,"Vahvista uusi salasana"),Oa(l.a.createElement(g.a,{name:"confirmPassword",onChange:a,placeholder:"trustno1 (eli sama uudestaan)",type:"password",value:n.confirmPassword})),l.a.createElement(O,{error:t.newPassword})))},ga={password:"",newPassword:"",confirmPassword:""},ka=function(e){function t(){var e;return Object(n.a)(this,t),(e=Object(r.a)(this,Object(c.a)(t).call(this))).handleChange=function(t,a){var n=a.name,r=a.value;return e.setState(Object(v.a)({},n,r))},e.handleSubmit=function(){var t=Object(J.a)(Q.a.mark(function t(a){var n,r,c;return Q.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:a.preventDefault(),n=e.props.auth,r=n.id,c=n.token,e.props.changePassword(r,e.state,c),e.setState(ga);case 4:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}(),e.render=function(){return l.a.createElement(y.a,{loading:e.props.pending,onSubmit:e.handleSubmit},l.a.createElement(ya,{errors:e.props.errors,onChange:e.handleChange,state:e.state}),l.a.createElement(z.a,{hidden:!0}),l.a.createElement(T.a,{content:"Vaihda",fluid:!0}))},e.state=ga,e}return Object(o.a)(t,e),t}(l.a.Component),ja=Object(S.b)(function(e){return{auth:e.auth,errors:e.employees.write.errors,pending:e.employees.write.pending}},{changePassword:function(e,t,a){return function(){var n=Object(J.a)(Q.a.mark(function n(r){var c;return Q.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return r(Qt.write()),n.prev=1,n.next=4,$.a.put("".concat("/api/employees","/").concat(e,"/password"),t,Z(a));case 4:r(Jt()),r(ae("Salasana vaihdettu","ok")),n.next=13;break;case 8:n.prev=8,n.t0=n.catch(1),(c=X(n.t0)).validation?r(Qt.writeInvalid(c.validation)):r(Qt.writeError()),r(ae(c.message,"error"));case 13:case"end":return n.stop()}},n,null,[[1,8]])}));return function(e){return n.apply(this,arguments)}}()}})(ka),wa=function(e){function t(){var e,a;Object(n.a)(this,t);for(var o=arguments.length,i=new Array(o),u=0;u<o;u++)i[u]=arguments[u];return(a=Object(r.a)(this,(e=Object(c.a)(t)).call.apply(e,[this].concat(i)))).componentDidMount=function(){return a.props.refresh(a.props.token)},a.componentWillUnmount=function(){return a.props.reset()},a.render=function(){return l.a.createElement("div",null,l.a.createElement(f,{title:"Perustiedot"},l.a.createElement(ha,{employee:a.props.employee||{}})),l.a.createElement(f,{title:"Suoritteet"},l.a.createElement(mt,{entities:a.props.activities,filter:gt,toRow:_t})),l.a.createElement(f,{title:"Salasanan vaihto"},l.a.createElement(ja,null)))},a}return Object(o.a)(t,e),t}(l.a.Component),Ca=Object(S.b)(function(e){var t=e.auth,a=t.id,n=t.token;return{activities:e.activities.data.items.filter(function(e){return e.owner.id===a}),employee:e.employees.data.items.find(function(e){return e.id===a}),token:n}},function(e){return{refresh:function(t){e(le(t))},reset:function(){e(Jt())}}})(wa),Ta=function(e){function t(){var e,a;Object(n.a)(this,t);for(var o=arguments.length,i=new Array(o),u=0;u<o;u++)i[u]=arguments[u];return(a=Object(r.a)(this,(e=Object(c.a)(t)).call.apply(e,[this].concat(i)))).componentDidMount=function(){return a.props.refresh(a.props.token)},a.render=function(){var e=a.props,t=e.error,n=e.match;return e.pending?l.a.createElement($e,null):t?l.a.createElement(Fe,{message:t}):l.a.createElement("div",null,l.a.createElement("h2",{className:"padded"},"Omat tietoni"),l.a.createElement(se.b,{component:Ca,exact:!0,path:n.path}))},a}return Object(o.a)(t,e),t}(l.a.Component),Ra=Object(S.b)(function(e){return{error:e.employees.data.error,pending:e.employees.data.pending,token:e.auth.token}},function(e){return{refresh:function(t){e($t(t))}}})(Ta),Ia=function(e){var t=e.city,a=e.street,n=e.zipCode,r=encodeURI("".concat(a,",").concat(n,",").concat(t));return"https://www.google.com/maps/embed/v1/place?key=".concat("AIzaSyDUfeWoQWNiGLhumfauHAzvwPpIU5_dzMA","&q=").concat(r)},Sa=function(e){var t=e.address,a=e.id;return l.a.createElement("div",{className:"padded"},l.a.createElement("iframe",{frameBorder:"0",height:"400",style:{border:0,width:"100%"},title:a,width:"640",src:Ia(t)}))},_a=function(e){return e.active?l.a.createElement("div",null,l.a.createElement(z.a,null),l.a.createElement(y.a,{onSubmit:e.onSubmit},l.a.createElement(y.a.Field,null,l.a.createElement("label",null,e.label),l.a.createElement(R.a,{onChange:e.onChange,options:e.options,placeholder:e.placeholder,search:!0,selection:!0,value:e.selected})),l.a.createElement(T.a,{content:e.button,fluid:!0}))):null},Aa=function(e){function t(){var e;return Object(n.a)(this,t),(e=Object(r.a)(this,Object(c.a)(t).call(this))).assign=function(t){t.preventDefault();var a=e.props,n=a.assignEmployeeToProject,r=a.auth;n(a.id,e.state,r.token)},e.handleChange=function(t,a){var n=a.value;return e.setState({id:n})},e.render=function(){var t=e.props,a=t.employees,n=t.project;return l.a.createElement("div",null,l.a.createElement(mt,{entities:a.filter(function(e){return n.employees.includes(e.id)}),filter:jt,toRow:Dt}),l.a.createElement(_a,{active:e.props.auth.admin,button:"Osoita",label:"Osoita ty\xf6ntekij\xe4 ty\xf6maalle",onChange:e.handleChange,onSubmit:e.assign,options:A(a,n),placeholder:"Valitse ty\xf6ntekij\xe4",selected:e.state.id}))},e.state={id:""},e}return Object(o.a)(t,e),t}(l.a.Component),Da=Object(S.b)(function(e){return{auth:e.auth,employees:e.employees.data.items}},{assignEmployeeToProject:function(e,t,a){return function(){var n=Object(J.a)(Q.a.mark(function n(r){var c,o;return Q.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return r(Et.write()),n.prev=1,n.next=4,$.a.post("".concat("/api/projects","/").concat(e,"/employees"),t,Z(a));case 4:c=n.sent,r(ht()),r(ft(c.data,t.id)),r(ae("Ty\xf6ntekij\xe4 osoitettu ty\xf6maalle","ok")),n.next=15;break;case 10:n.prev=10,n.t0=n.catch(1),o=X(n.t0),r(Et.writeError()),r(ae(o.message,"error"));case 15:case"end":return n.stop()}},n,null,[[1,10]])}));return function(e){return n.apply(this,arguments)}}()}})(Aa),Na=function(e){var t=e.errors,a=e.onChange,n=e.readOnly,r=e.state;return l.a.createElement("div",null,l.a.createElement(y.a.Field,{error:void 0!==t.projectId},l.a.createElement("label",null,"Ty\xf6numero"),l.a.createElement(g.a,{name:"projectId",onChange:a,readOnly:n,value:r.projectId}),l.a.createElement(O,{error:t.projectId})),l.a.createElement(y.a.Field,{error:void 0!==t.name},l.a.createElement("label",null,"Ty\xf6maan nimi / kuvaus"),l.a.createElement(g.a,{name:"name",onChange:a,readOnly:n,value:r.name}),l.a.createElement(O,{error:t.name})),l.a.createElement(y.a.Field,{error:void 0!==t.manager},l.a.createElement("label",null,"Ty\xf6njohtaja / vastuuhenkil\xf6"),l.a.createElement(R.a,{disabled:n,name:"manager",onChange:a,options:e.managers,placeholder:"Valitse ty\xf6njohtaja",search:!0,selection:!0,value:r.manager}),l.a.createElement(O,{error:t.manager})),l.a.createElement(y.a.Field,{error:void 0!==t.startDate},l.a.createElement("label",null,"Alkaa"),l.a.createElement(g.a,{icon:"calendar",name:"startDate",onChange:a,placeholder:"pp-kk-vvvv",readOnly:n,type:"date",value:r.startDate}),l.a.createElement(O,{error:t.startDate})),l.a.createElement(y.a.Field,{error:void 0!==t.endDate},l.a.createElement("label",null,"P\xe4\xe4ttyy"),l.a.createElement(g.a,{icon:"calendar",name:"endDate",onChange:a,placeholder:"pp-kk-vvvv",readOnly:n,type:"date",value:r.endDate}),l.a.createElement(O,{error:t.endDate})),l.a.createElement(y.a.Field,{error:void 0!==t.client},l.a.createElement("label",null,"Asiakas"),l.a.createElement(R.a,{disabled:!e.isNew||n,name:"client",onChange:a,options:e.clients,placeholder:"Valitse asiakas",readOnly:n,search:!0,selection:!0,value:r.client}),l.a.createElement(O,{error:t.client})),l.a.createElement(y.a.Field,{error:void 0!==t.contactPerson},l.a.createElement("label",null,"Asiakkaan yhteyshenkil\xf6"),l.a.createElement(g.a,{name:"contactPerson",onChange:a,placeholder:"Saumausta hoitava mestari",readOnly:n,value:r.contactPerson}),l.a.createElement(O,{error:t.contactPerson})),l.a.createElement(y.a.Field,{error:void 0!==t.phone},l.a.createElement("label",null,"Yhteyshenkil\xf6n puhelin"),l.a.createElement(g.a,{name:"phone",onChange:a,placeholder:"040-123-4567",readOnly:n,value:r.phone}),l.a.createElement(O,{error:t.phone})))},xa=function(e){function t(e){var a;return Object(n.a)(this,t),(a=Object(r.a)(this,Object(c.a)(t).call(this,e))).handleChange=function(e,t){var n=t.name,r=t.value;return a.setState(Object(v.a)({},n,r))},a.handleSubmit=function(e){e.preventDefault();var t=a.props,n=t.history,r=t.id,c=t.isNew,o=t.token;a.props.save(a.state,n,r,c,o)},a.syncAddressState=function(e){return a.setState(Object(h.a)({},a.state,{address:e}))},a.render=function(){return l.a.createElement(y.a,{loading:a.props.pending,onSubmit:a.handleSubmit},l.a.createElement(Na,{clients:a.props.clients,errors:a.props.errors,isNew:a.props.isNew,managers:a.props.managers,onChange:a.handleChange,readOnly:a.props.readOnly,state:a.state}),l.a.createElement(z.a,{hidden:!0}),l.a.createElement(Gt,{address:a.state.address,errors:a.props.errors,readOnly:a.props.readOnly,sync:a.syncAddressState}),l.a.createElement(z.a,{hidden:!0}),a.props.readOnly?null:l.a.createElement(T.a,{content:"Tallenna",fluid:!0}))},a.state=q(e.project),a}return Object(o.a)(t,e),t}(l.a.Component),Fa=Object(se.f)(Object(S.b)(function(e,t){return{clients:(n=e.clients.data.items,r=t.project,r&&r.client?[{key:r.client.id,text:r.client.legalEntity,value:r.client.id}]:n.map(function(e){return{key:e.id,text:e.legalEntity,value:e.id}}).sort(function(e,t){return e.text.localeCompare(t.text)})),errors:e.projects.write.errors,managers:(a=e.employees.data.items,a.filter(function(e){return e.administrator}).map(function(e){return{key:e.id,text:"".concat(e.lastName,", ").concat(e.firstName),value:e.id}}).sort(function(e,t){return e.text.localeCompare(t.text)})),pending:e.projects.write.pending,readOnly:!e.auth.admin,token:e.auth.token};var a,n,r},function(e){return{save:function(t,a,n,r,c){e(r?function(e,t,a){return function(){var n=Object(J.a)(Q.a.mark(function n(r){var c,o;return Q.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return r(Et.write()),n.prev=1,n.next=4,$.a.post("/api/projects",e,Z(t));case 4:c=n.sent,r(ht()),r(Et.createOk(c.data)),r(ae("Uusi ty\xf6maa lis\xe4tty","ok")),a.replace("/projects/".concat(c.data.id)),n.next=16;break;case 11:n.prev=11,n.t0=n.catch(1),(o=X(n.t0)).validation?r(Et.writeInvalid(o.validation)):r(Et.writeError()),r(ae(o.message,"error"));case 16:case"end":return n.stop()}},n,null,[[1,11]])}));return function(e){return n.apply(this,arguments)}}()}(t,c,a):Ot(n,t,c))}}})(xa)),Pa=Object(S.b)(function(e,t){return{admin:e.auth.admin,tasks:e.tasks.data.items.filter(function(e){return e.project.id===t.id})}},null)(function(e){var t=e.admin,a=e.id,n=e.tasks;return l.a.createElement("div",null,l.a.createElement(mt,{entities:n,filter:It,toRow:Lt}),l.a.createElement(Kt,{active:t,href:"/tasks/new?id=".concat(a),label:"Lis\xe4\xe4 uusi teht\xe4v\xe4"}))}),La=function(e){function t(){var e,a;Object(n.a)(this,t);for(var o=arguments.length,i=new Array(o),u=0;u<o;u++)i[u]=arguments[u];return(a=Object(r.a)(this,(e=Object(c.a)(t)).call.apply(e,[this].concat(i)))).componentDidMount=function(){return a.props.refresh(a.props.token)},a.componentWillUnmount=function(){return a.props.reset()},a.render=function(){var e=a.props,t=e.id,n=e.isNew,r=e.project;return n||r?l.a.createElement("div",null,l.a.createElement(f,{active:n,title:"Perustiedot"},l.a.createElement(Fa,{id:t,isNew:n,project:r||{}})),n?null:l.a.createElement("div",null,l.a.createElement(f,{title:"N\xe4yt\xe4 kartalla"},l.a.createElement(Sa,{address:r.address,id:t})),l.a.createElement(f,{title:"Ty\xf6ntekij\xe4t"},l.a.createElement(Da,{id:t,project:r||{}})),l.a.createElement(f,{title:"Teht\xe4v\xe4t"},l.a.createElement(Pa,{id:t})),l.a.createElement(f,{active:r.attachments.length>0,title:"Liitteet"},l.a.createElement(Re,{attachments:r.attachments||[],entity:"Project",id:t,thunk:Ot})),l.a.createElement(f,{active:r.comments.length>0,title:"Huomiot"},l.a.createElement(Ne,{comments:r.comments||[],entity:"Project",id:t,thunk:vt})))):l.a.createElement(Fe,null)},a}return Object(o.a)(t,e),t}(l.a.Component),Ha=Object(S.b)(function(e,t){var a=t.match.params.id;return{id:a,isNew:"new"===a,project:e.projects.data.items.find(function(e){return e.id===a}),token:e.auth.token}},function(e){return{refresh:function(t){e(ct(t)),e($t(t)),e(ze(t))},reset:function(){e(ht())}}})(La),Wa=function(e){var t=document.createElement("script");t.async=!0,t.defer=!0,t.id="google-map-api",t.src="https://maps.googleapis.com/maps/api/js?key=".concat(e),t.type="text/javascript",document.body.appendChild(t)},Ka=function(e,t){setTimeout(function(){var a=window.google.maps,n=a.Map,r=a.Marker,c=new n(e.current,{center:{lat:60.25,lng:24.95},zoom:10});t.filter(function(e){return!!e.location}).map(function(e){return e.location}).map(function(e){return new r({map:c,position:e})})},50)},Ua=function(e){function t(){var e;return Object(n.a)(this,t),(e=Object(r.a)(this,Object(c.a)(t).call(this))).componentDidMount=function(){document.getElementById("google-map-api")||Wa("AIzaSyDUfeWoQWNiGLhumfauHAzvwPpIU5_dzMA")},e.render=function(){return window.google?l.a.createElement("div",{ref:e.mapRef,style:{height:"400px",width:"100%"}},Ka(e.mapRef,e.props.addresses)):null},e.mapRef=l.a.createRef(),e}return Object(o.a)(t,e),t}(l.a.Component),Ma=Object(S.b)(function(e){return{addresses:e.projects.data.items.map(function(e){return e.address})}},null)(Ua),Va=Object(S.b)(function(e){return{admin:e.auth.admin,projects:e.projects.data.items}},null)(function(e){var t=e.admin,a=e.projects;return l.a.createElement("div",null,l.a.createElement(mt,{entities:a,filter:Ct,toRow:xt}),l.a.createElement(Kt,{active:t,href:"/projects/new",label:"Lis\xe4\xe4 uusi ty\xf6maa"}),l.a.createElement(z.a,{hidden:!0}),l.a.createElement(f,{title:"N\xe4yt\xe4 kartalla"},l.a.createElement(Ma,null)))}),qa=function(e){function t(){var e,a;Object(n.a)(this,t);for(var o=arguments.length,i=new Array(o),u=0;u<o;u++)i[u]=arguments[u];return(a=Object(r.a)(this,(e=Object(c.a)(t)).call.apply(e,[this].concat(i)))).componentDidMount=function(){return a.props.refresh(a.props.token)},a.render=function(){var e=a.props,t=e.error,n=e.match;return e.pending?l.a.createElement($e,null):t?l.a.createElement(Fe,{message:t}):l.a.createElement("div",null,l.a.createElement("h2",{className:"padded"},"Ty\xf6maat"),l.a.createElement(se.b,{component:Ha,exact:!0,path:"".concat(n.path,"/:id")}),l.a.createElement(se.b,{component:Va,exact:!0,path:n.path}))},a}return Object(o.a)(t,e),t}(l.a.Component),Ga=Object(S.b)(function(e){return{error:e.projects.data.error,pending:e.projects.data.pending,token:e.auth.token}},function(e){return{refresh:function(t){e(bt(t))}}})(qa),za=Object(S.b)(function(e,t){var a=(t.task.project||[]).employees;return{activities:e.activities.data.items.filter(function(e){return e.task.id===t.id}),isOwner:a.includes(e.auth.id)}},null)(function(e){var t=e.activities,a=e.isOwner,n=e.task;return l.a.createElement("div",null,l.a.createElement(mt,{entities:t,filter:yt,toRow:St}),l.a.createElement(Kt,{active:a&&!n.completed,href:"/activities/new?id=".concat(n.id),label:"Lis\xe4\xe4 uusi suorite"}))}),Ya=function(e){var t=e.errors,a=e.onChange,n=e.project,r=e.readOnly,c=e.state;return l.a.createElement("div",null,l.a.createElement(y.a.Field,null,l.a.createElement("label",null,"Ty\xf6maan ty\xf6numero ja nimi"),l.a.createElement(g.a,{disabled:!0,value:"".concat(n.projectId," \u2014 ").concat(n.name)||""})),l.a.createElement(y.a.Field,{error:void 0!==t.name},l.a.createElement("label",null,"Otsikko"),l.a.createElement(g.a,{name:"name",onChange:a,placeholder:"N\xe4kyy teht\xe4vi\xe4 listattaessa",readOnly:r,value:c.name}),l.a.createElement(O,{error:t.name})),l.a.createElement(y.a.Field,{error:void 0!==t.description},l.a.createElement("label",null,"Kuvaus"),l.a.createElement(k.a,{autoHeight:!0,name:"description",onChange:a,placeholder:"Kirjoita teht\xe4v\xe4n kuvaus",readOnly:r,style:{minHeight:100},value:c.description}),l.a.createElement(O,{error:t.description})),l.a.createElement(y.a.Field,{error:void 0!==t.startDate},l.a.createElement("label",null,"Alkaa"),l.a.createElement(g.a,{icon:"calendar",name:"startDate",onChange:a,placeholder:"pp-kk-vvvv",readOnly:r,type:"date",value:c.startDate}),l.a.createElement(O,{error:t.startDate})),l.a.createElement(y.a.Field,{error:void 0!==t.endDate},l.a.createElement("label",null,"P\xe4\xe4ttyy"),l.a.createElement(g.a,{icon:"calendar",name:"endDate",onChange:a,placeholder:"pp-kk-vvvv",readOnly:r,type:"date",value:c.endDate}),l.a.createElement(O,{error:t.endDate})),l.a.createElement(y.a.Field,{error:void 0!==t.daysNeeded},l.a.createElement("label",null,"Ty\xf6m\xe4\xe4r\xe4arvio"),l.a.createElement(g.a,{label:{basic:!0,content:"p\xe4iv\xe4\xe4"},labelPosition:"right",name:"daysNeeded",onChange:a,placeholder:"Py\xf6ristyy l\xe4himp\xe4\xe4n kokonaislukuun",readOnly:r,value:c.daysNeeded}),l.a.createElement(O,{error:t.daysNeeded})))},Qa=function(e){function t(e){var a;return Object(n.a)(this,t),(a=Object(r.a)(this,Object(c.a)(t).call(this,e))).handleChange=function(e,t){var n="checkbox"===t.type?t.checked:t.value;a.setState(Object(v.a)({},t.name,n))},a.handleSubmit=function(e){e.preventDefault(e);var t=a.props,n=t.history,r=t.id,c=t.isNew,o=t.project,i=t.token;a.props.save(a.state,n,r,c,o,i)},a.syncQuotaState=function(e){return a.setState(Object(h.a)({},a.state,{quotas:e}))},a.render=function(){return l.a.createElement(y.a,{loading:a.props.pending,onSubmit:a.handleSubmit},l.a.createElement(Ya,{errors:a.props.errors,onChange:a.handleChange,project:a.props.task.project||{},readOnly:a.props.readOnly,state:a.state}),l.a.createElement(z.a,null),l.a.createElement(N,{header:"Materiaaliarvio",quotas:a.state.quotas,readOnly:a.props.readOnly,sync:a.syncQuotaState}),l.a.createElement(z.a,{hidden:!0}),l.a.createElement(y.a.Field,{className:"padded"},l.a.createElement(y.a.Checkbox,{checked:a.state.completed,label:"Suoritettu loppuun",name:"completed",onChange:a.handleChange,readOnly:a.props.readOnly})),l.a.createElement(z.a,{hidden:!0}),a.props.readOnly?null:l.a.createElement(T.a,{content:"Tallenna",fluid:!0}))},a.state=G(e.task),a}return Object(o.a)(t,e),t}(l.a.Component),Ja=Object(se.f)(Object(S.b)(function(e){return{errors:e.tasks.write.errors,pending:e.tasks.write.pending,readOnly:!e.auth.admin,token:e.auth.token}},function(e){return{save:function(t,a,n,r,c,o){var i=Object(h.a)({},t,{daysNeeded:F(t.daysNeeded),project:c.id||null,quotas:P(t.quotas)});return e(r?function(e,t,a){return function(){var n=Object(J.a)(Q.a.mark(function n(r){var c,o;return Q.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return r(Ve.write()),n.prev=1,n.next=4,$.a.post("/api/tasks",e,Z(t));case 4:c=n.sent,r(qe()),r(Ve.createOk(c.data)),r(ae("Teht\xe4v\xe4 lis\xe4tty","ok")),a.replace("/tasks/".concat(c.data.id)),n.next=16;break;case 11:n.prev=11,n.t0=n.catch(1),(o=X(n.t0)).validation?r(Ve.writeInvalid(o.validation)):r(Ve.writeError()),r(ae(o.message,"error"));case 16:case"end":return n.stop()}},n,null,[[1,11]])}));return function(e){return n.apply(this,arguments)}}()}(i,o,a):Ye(n,i,o))}}})(Qa)),Ba=function(e){function t(){var e,a;Object(n.a)(this,t);for(var o=arguments.length,i=new Array(o),u=0;u<o;u++)i[u]=arguments[u];return(a=Object(r.a)(this,(e=Object(c.a)(t)).call.apply(e,[this].concat(i)))).componentDidMount=function(){return a.props.refresh(a.props.token)},a.componentWillUnmount=function(){return a.props.reset()},a.render=function(){var e=a.props,t=e.id,n=e.isNew,r=e.project,c=e.task;return n||c?n&&!r?l.a.createElement(Fe,{message:"Virheellinen ty\xf6maan tunniste, \xe4l\xe4 sooloile osoitepalkin kanssa!"}):l.a.createElement("div",null,l.a.createElement(f,{active:n,title:"Perustiedot"},l.a.createElement(Ja,{id:t,isNew:n,project:r||{},task:c||{project:r}})),n?null:l.a.createElement("div",null,l.a.createElement(f,{title:"Suoritteet"},l.a.createElement(za,{id:t,task:c})),l.a.createElement(f,{active:c.attachments.length>0,title:"Liitteet"},l.a.createElement(Re,{attachments:c.attachments||[],entity:"Task",id:t,thunk:Ye})),l.a.createElement(f,{active:c.comments.length>0,title:"Huomiot"},l.a.createElement(Ne,{comments:c.comments||[],entity:"Task",id:t,thunk:Ge})))):l.a.createElement(Fe,null)},a}return Object(o.a)(t,e),t}(l.a.Component),$a=Object(S.b)(function(e,t){var a=t.match.params.id,n=L(t.location.search).id;return{id:a,isNew:"new"===a,project:e.projects.data.items.find(function(e){return e.id===n}),task:e.tasks.data.items.find(function(e){return e.id===a}),token:e.auth.token}},function(e){return{refresh:function(t){e(le(t)),e(Ke(t)),e(bt(t))},reset:function(){e(qe())}}})(Ba),Za=Object(S.b)(function(e){return{tasks:e.tasks.data.items}},null)(function(e){var t=e.tasks;return l.a.createElement(mt,{entities:t,filter:Rt,toRow:Pt})}),Xa=function(e){function t(){var e,a;Object(n.a)(this,t);for(var o=arguments.length,i=new Array(o),u=0;u<o;u++)i[u]=arguments[u];return(a=Object(r.a)(this,(e=Object(c.a)(t)).call.apply(e,[this].concat(i)))).componentDidMount=function(){return a.props.refresh(a.props.token)},a.render=function(){var e=a.props,t=e.error,n=e.match;return e.pending?l.a.createElement($e,null):t?l.a.createElement(Fe,{message:t}):l.a.createElement("div",null,l.a.createElement("h2",{className:"padded"},"Teht\xe4v\xe4t"),l.a.createElement(se.b,{component:$a,exact:!0,path:"".concat(n.path,"/:id")}),l.a.createElement(se.b,{component:Za,exact:!0,path:n.path}))},a}return Object(o.a)(t,e),t}(l.a.Component),en=Object(S.b)(function(e){return{error:e.tasks.data.error,pending:e.tasks.data.pending,token:e.auth.token}},function(e){return{refresh:function(t){e(ze(t))}}})(Xa),tn=Object(se.f)(function(){return l.a.createElement(se.d,null,l.a.createElement(se.b,{component:Xe,path:"/activities"}),l.a.createElement(se.b,{component:Vt,path:"/clients"}),l.a.createElement(se.b,{component:ca,path:"/employees"}),l.a.createElement(se.b,{component:pa,path:"/materials"}),l.a.createElement(se.b,{component:Ra,path:"/my"}),l.a.createElement(se.b,{component:Ga,path:"/projects"}),l.a.createElement(se.b,{component:en,path:"/tasks"}),l.a.createElement(se.a,{to:"/projects"}))}),an=function(e){var t=e.error,a=e.onChange,n=e.onSubmit,r=e.pending,c=e.state;return l.a.createElement(y.a,{loading:r,onSubmit:n},l.a.createElement(y.a.Field,{error:null!==t},l.a.createElement("label",null,"Anna k\xe4ytt\xe4j\xe4tunnukseesi sidottu email"),l.a.createElement(g.a,{name:"email",onChange:a,placeholder:"paavo@firma.io",value:c.email}),l.a.createElement(O,{error:t})),l.a.createElement(T.a,{content:"Pyyd\xe4 uusi salasana",fluid:!0}))},nn=function(e){var t=e.error,a=e.onChange,n=e.state,r=n.password,c=n.username,o=0===r.length||0===c.length;return l.a.createElement("div",null,l.a.createElement("h2",{className:"padded"},"Kirjaudu sis\xe4\xe4n"),l.a.createElement(y.a,{loading:e.pending,onSubmit:e.onSubmit},l.a.createElement(y.a.Field,{error:null!==t},l.a.createElement("label",null,"K\xe4ytt\xe4j\xe4tunnus"),l.a.createElement(g.a,{name:"username",onChange:a,placeholder:"spongebob",value:c})),l.a.createElement(y.a.Field,{error:null!==t},l.a.createElement("label",null,"Salasana"),l.a.createElement(g.a,{name:"password",onChange:a,placeholder:"qwerty",type:"password",value:r}),l.a.createElement(O,{error:t})),l.a.createElement(T.a,{content:"Kirjaudu",disabled:o,fluid:!0})))},rn=function(e){return{type:"SET_AUTH",payload:e}},cn=function(){return function(e){localStorage.removeItem("sauma_auth"),e({type:"LOGOUT"})}},on=function(e){function t(){var e;return Object(n.a)(this,t),(e=Object(r.a)(this,Object(c.a)(t).call(this))).handleChange=function(t,a){var n=a.name,r=a.value;return e.setState(Object(v.a)({},n,r))},e.handleForgot=function(t){t.preventDefault(),e.props.forgot(e.state.email,e.expandable.toggle)},e.handleLogin=function(t){t.preventDefault();var a=e.state,n=a.password,r=a.username;e.props.login(r,n),e.setState({password:"",username:""})},e.render=function(){return l.a.createElement("div",null,l.a.createElement(nn,{error:e.props.error,onChange:e.handleChange,onSubmit:e.handleLogin,pending:e.props.pending,state:e.state}),l.a.createElement(z.a,null),l.a.createElement(we,{button:"Unohtuiko salasana?",ref:function(t){return e.expandable=t}},l.a.createElement(an,{error:e.props.forgotError,onChange:e.handleChange,onSubmit:e.handleForgot,pending:e.props.forgotPending,state:e.state})))},e.state={email:"",password:"",username:""},e}return Object(o.a)(t,e),t}(l.a.Component),ln=Object(S.b)(function(e){return{error:e.auth.error,forgotError:e.auth.forgotError,forgotPending:e.auth.forgotPending,pending:e.auth.pending}},{forgot:function(e,t){return function(){var a=Object(J.a)(Q.a.mark(function a(n){return Q.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return n({type:"FORGOT"}),a.prev=1,a.next=4,$.a.post("".concat("/api/login","/forgot"),{email:e});case 4:n({type:"FORGOT_OK"}),n(ae("Ohjeet l\xe4hetetty s\xe4hk\xf6postiin","ok")),t&&t(),a.next=12;break;case 9:a.prev=9,a.t0=a.catch(1),n({type:"FORGOT_ERROR",payload:"Tuntematon email tai suljettu k\xe4ytt\xe4j\xe4tunnus"});case 12:case"end":return a.stop()}},a,null,[[1,9]])}));return function(e){return a.apply(this,arguments)}}()},login:function(e,t){return function(){var a=Object(J.a)(Q.a.mark(function a(n){var r,c;return Q.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return n({type:"LOGIN"}),a.prev=1,a.next=4,$.a.post("/api/login",{username:e,password:t});case 4:r=a.sent,c=r.data,localStorage.setItem("sauma_auth",JSON.stringify(c)),n(rn(c)),n(ae("Olet kirjautunut sis\xe4\xe4n. Tervetuloa, ".concat(c.firstName,"!"),"ok")),a.next=14;break;case 11:a.prev=11,a.t0=a.catch(1),n({type:"LOGIN_ERROR",payload:"Virheellinen tunnus tai salasana"});case 14:case"end":return a.stop()}},a,null,[[1,11]])}));return function(e){return a.apply(this,arguments)}}()}})(on),un=function(e){return l.a.createElement(ba.a,{content:l.a.createElement(va,null),header:"Vaatimukset",on:"focus",trigger:e})},sn=function(e){var t=e.error,a=e.onChange,n=e.onSubmit,r=e.pending,c=e.state;return l.a.createElement(y.a,{loading:r,onSubmit:n},l.a.createElement(y.a.Field,{error:null!==t},l.a.createElement("label",null,"Uusi salasana"),un(l.a.createElement(g.a,{name:"newPassword",onChange:a,placeholder:"trustno1",type:"password",value:c.newPassword}))),l.a.createElement(y.a.Field,{error:null!==t},l.a.createElement("label",null,"Vahvista uusi salasana"),un(l.a.createElement(g.a,{name:"confirmPassword",onChange:a,placeholder:"trustno1 (eli sama uudestaan)",type:"password",value:c.confirmPassword})),l.a.createElement(O,{error:t})),l.a.createElement(T.a,{content:"Vaihda",fluid:!0}))},dn={newPassword:"",confirmPassword:""},mn=function(e){function t(){var e;return Object(n.a)(this,t),(e=Object(r.a)(this,Object(c.a)(t).call(this))).handleChange=function(t,a){var n=a.name,r=a.value;return e.setState(Object(v.a)({},n,r))},e.handleSubmit=function(){var t=Object(J.a)(Q.a.mark(function t(a){var n,r,c;return Q.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:a.preventDefault(),n=e.props,r=n.history,c=n.token,e.props.resetPassword(e.state,c,r),e.setState(dn);case 4:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}(),e.render=function(){return l.a.createElement("div",null,l.a.createElement("h2",{className:"padded"},"Vaihda salasana"),l.a.createElement(sn,{error:e.props.error,onChange:e.handleChange,onSubmit:e.handleSubmit,pending:e.props.pending,state:e.state}))},e.state=dn,e}return Object(o.a)(t,e),t}(l.a.Component),pn=Object(S.b)(function(e,t){return{error:e.auth.error,pending:e.auth.pending,token:t.match.params.token}},{resetPassword:function(e,t,a){return function(){var n=Object(J.a)(Q.a.mark(function n(r){var c,o;return Q.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return r({type:"LOGIN"}),n.prev=1,n.next=4,$.a.post("".concat("/api/login","/reset/").concat(t),e);case 4:r({type:"LOGIN_OK"}),r(ae("Salasana vaihdettu","ok")),a.replace("/"),r(cn()),n.next=15;break;case 10:n.prev=10,n.t0=n.catch(1),c=n.t0.response.data.ValidationError,o=c?c.newPassword:"Virheellinen tai vanhentunut tunniste",r({type:"LOGIN_ERROR",payload:o});case 15:case"end":return n.stop()}},n,null,[[1,10]])}));return function(e){return n.apply(this,arguments)}}()}})(mn),En=Object(se.f)(function(){return l.a.createElement(se.d,null,l.a.createElement(se.b,{component:pn,exact:!0,path:"/reset/:token"}),l.a.createElement(se.b,{component:ln,path:"/"}),l.a.createElement(se.a,{to:"/"}))}),fn=function(e){function t(){var e,a;Object(n.a)(this,t);for(var o=arguments.length,i=new Array(o),u=0;u<o;u++)i[u]=arguments[u];return(a=Object(r.a)(this,(e=Object(c.a)(t)).call.apply(e,[this].concat(i)))).handleClick=function(e){e.preventDefault(),a.props.history.goBack()},a.render=function(){var e=a.props.history.location.pathname;return(e?e.split("/"):[]).length<3?null:l.a.createElement(p.a,{inverted:!0,name:"angle double left",onClick:a.handleClick,size:"large"})},a}return Object(o.a)(t,e),t}(i.Component),hn=Object(se.f)(fn),vn=a(473),bn=function(e){return[{key:"projects",content:"Ty\xf6maat",as:ye.b,to:"/projects",admin:0},{key:"tasks",content:"Teht\xe4v\xe4t",as:ye.b,to:"/tasks",admin:0},{key:"clients",content:"Asiakkaat",as:ye.b,to:"/clients",admin:1},{key:"materials",content:"Materiaalit",as:ye.b,to:"/materials",admin:0},{key:"employees",content:"Henkil\xf6st\xf6",as:ye.b,to:"/employees",admin:0},{key:"my",content:"Oma sivu",as:ye.b,to:"/my",admin:0},{key:"logout",content:"Kirjaudu ulos",as:ye.b,to:"/",onClick:e,admin:0}]},On=function(e,t){return l.a.createElement(vn.a,{items:e?bn(t):bn(t).filter(function(e){return 0===e.admin}),secondary:!0,vertical:!0})},yn=function(e){var t=e.auth,a=e.logout;return l.a.createElement(ba.a,{content:On(t.admin,a),on:"click",trigger:l.a.createElement(p.a,{inverted:!0,name:"bars",size:"large"})})},gn=function(e){function t(){var e,a;Object(n.a)(this,t);for(var o=arguments.length,i=new Array(o),s=0;s<o;s++)i[s]=arguments[s];return(a=Object(r.a)(this,(e=Object(c.a)(t)).call.apply(e,[this].concat(i)))).handleLogout=function(){return a.props.logout()},a.render=function(){var e=a.props.auth;return l.a.createElement("div",{className:"full-width-bg-black"},l.a.createElement("div",{className:"wrapper",style:{padding:"0.5rem 1.5rem 0.5rem 0rem"}},l.a.createElement(u.a,null,e.token?l.a.createElement(d.a,null,l.a.createElement(d.a.Column,{floated:"left"},l.a.createElement(hn,null)),l.a.createElement(d.a.Column,{floated:"right"},l.a.createElement(yn,{auth:a.props.auth,logout:a.handleLogout}))):l.a.createElement(p.a,{name:"",size:"large"}))))},a}return Object(o.a)(t,e),t}(l.a.Component),kn=Object(S.b)(function(e){return{auth:e.auth}},{logout:cn})(gn),jn=a(469),wn=Object(S.b)(function(e){return{notification:e.notification}},null)(function(e){var t=e.notification;return t.message?l.a.createElement(jn.a,{basic:!0,closeOnDimmerClick:!0,defaultOpen:!0,size:"mini"},l.a.createElement(m.a,{color:"error"===t.type?"red":"green",content:t.message,icon:"error"===t.type?"warning sign":"checkmark",inverted:!0})):null}),Cn=function(e){function t(){var e,a;Object(n.a)(this,t);for(var o=arguments.length,i=new Array(o),d=0;d<o;d++)i[d]=arguments[d];return(a=Object(r.a)(this,(e=Object(c.a)(t)).call.apply(e,[this].concat(i)))).componentDidMount=function(){return a.props.checkAuth()},a.render=function(){return l.a.createElement("div",null,l.a.createElement(s,null),l.a.createElement(kn,null),l.a.createElement("div",{className:"wrapper padded"},l.a.createElement(u.a,null,l.a.createElement(wn,null),a.props.auth.token?l.a.createElement(tn,null):l.a.createElement(En,null))))},a}return Object(o.a)(t,e),t}(l.a.Component),Tn=Object(S.b)(function(e){return{auth:e.auth}},{checkAuth:function(){return function(e){var t=JSON.parse(localStorage.getItem("sauma_auth"));e(t?rn(t):cn())}}})(Cn),Rn=a(52),In=a(252),Sn=a(35),_n=a(253),An={error:null,pending:!1,forgotError:null,forgotPending:!1},Dn=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:An,t=arguments.length>1?arguments[1]:void 0,a=t.payload;switch(t.type){case"LOGIN":return Object(h.a)({},e,{pending:!0});case"LOGIN_ERROR":return Object(h.a)({},e,{error:a,pending:!1});case"LOGIN_OK":return Object(h.a)({},e,{error:null,pending:!1});case"SET_AUTH":return Object(h.a)({},An,a);case"FORGOT":return Object(h.a)({},e,{forgotPending:!0});case"FORGOT_ERROR":return Object(h.a)({},e,{forgotError:a,forgotPending:!1});case"FORGOT_OK":return Object(h.a)({},e,{forgotError:null,forgotPending:!1});case"LOGOUT":return An;default:return e}},Nn=function(e){var t={items:[],error:null,pending:!1,updated:1};return function(){var a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:t,n=arguments.length>1?arguments[1]:void 0,r=n.payload;switch(n.type){case e.FETCH:return Object(h.a)({},a,{pending:!0});case e.FETCH_OK:return{items:r,error:null,pending:!1,updated:Date.now()};case e.FETCH_ERROR:return Object(h.a)({},a,{error:r,pending:!1});case e.CREATED:return Object(h.a)({},a,{items:[].concat(Object(w.a)(a.items),[r])});case e.UPDATED:var c=a.items.filter(function(e){return e.id!==r.id});return Object(h.a)({},a,{items:[].concat(Object(w.a)(c),[r])});case"LOGOUT":return t;default:return a}}},xn=function(e){var t={pending:!1};return function(){var a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:t;switch((arguments.length>1?arguments[1]:void 0).type){case e.REQUEST_START:return{pending:!0};case e.REQUEST_OVER:return{pending:!1};case"LOGOUT":return t;default:return a}}},Fn=function(e){var t={errors:{},pending:!1};return function(){var a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:t,n=arguments.length>1?arguments[1]:void 0,r=n.payload;switch(n.type){case e.WRITE:return Object(h.a)({},a,{pending:!0});case e.WRITE_ERROR:return Object(h.a)({},a,{pending:!1});case e.WRITE_INVALID:return{errors:r,pending:!1};case e.WRITE_RESET:return t;default:return a}}},Pn={items:[],error:null,pending:!1,updated:1},Ln=Object(Sn.combineReducers)({data:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Pn,t=arguments.length>1?arguments[1]:void 0,a=t.payload;switch(t.type){case Yt.FETCH:return Object(h.a)({},e,{pending:!0});case Yt.FETCH_OK:return{items:a,error:null,pending:!1,updated:Date.now()};case Yt.FETCH_ERROR:return Object(h.a)({},e,{error:a,pending:!1});case Yt.CREATED:return Object(h.a)({},e,{items:[].concat(Object(w.a)(e.items),[a])});case Yt.UPDATED:var n=e.items.filter(function(e){return e.id!==a.id});return Object(h.a)({},e,{items:[].concat(Object(w.a)(n),[a])});case Yt.ASSIGNED:var r=a.employee,c=a.project,o=e.items.filter(function(e){return e.id!==r}),i=e.items.find(function(e){return e.id===r});return i.projects=i.projects.concat(c.id),Object(h.a)({},e,{items:[].concat(Object(w.a)(o),[i])});case"LOGOUT":return Pn;default:return e}},write:Fn(Yt)}),Hn={message:null,type:null,stack:0},Wn=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Hn,t=arguments.length>1?arguments[1]:void 0,a=t.payload;switch(t.type){case"HIDE_NOTIFICATION":return e.stack<2?Hn:Object(h.a)({},e,{stack:e.stack-1});case"SET_NOTIFICATION":return Object(h.a)({},a,{stack:e.stack+1});default:return e}},Kn={items:[],error:null,pending:!1,updated:1},Un=Object(Sn.combineReducers)({data:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Kn,t=arguments.length>1?arguments[1]:void 0,a=t.payload;switch(t.type){case pt.FETCH:return Object(h.a)({},e,{pending:!0});case pt.FETCH_OK:return{items:a,error:null,pending:!1,updated:Date.now()};case pt.FETCH_ERROR:return Object(h.a)({},e,{error:a,pending:!1});case pt.CREATED:return Object(h.a)({},e,{items:[].concat(Object(w.a)(e.items),[a])});case pt.UPDATED:var n=e.items.filter(function(e){return e.id!==a.id});return Object(h.a)({},e,{items:[].concat(Object(w.a)(n),[a])});case pt.ASSIGNED:var r=a.project,c=e.items.filter(function(e){return e.id!==r.id});return Object(h.a)({},e,{items:[].concat(Object(w.a)(c),[r])});case"LOGOUT":return Kn;default:return e}},write:Fn(pt)}),Mn=Object(Sn.combineReducers)({data:Nn(re),write:Fn(re)}),Vn=xn(Ce),qn=Object(Sn.combineReducers)({data:Nn(tt),write:Fn(tt)}),Gn=xn(Ae),zn=Object(Sn.combineReducers)({data:Nn(Pe),write:Fn(Pe)}),Yn=Object(Sn.combineReducers)({data:Nn(Me),write:Fn(Me)}),Qn=Object(Sn.combineReducers)({activities:Mn,attachments:Vn,auth:Dn,clients:qn,comments:Gn,employees:Ln,materials:zn,notification:Wn,projects:Un,tasks:Yn}),Jn=Object(Sn.createStore)(Qn,Object(_n.composeWithDevTools)(Object(Sn.applyMiddleware)(In.a)));a(453);Object(Rn.render)(l.a.createElement(S.a,{store:Jn},l.a.createElement(ye.a,null,l.a.createElement(se.b,{component:Tn,path:"/"}))),document.getElementById("root"))}},[[263,1,2]]]);
//# sourceMappingURL=main.fbc357a0.chunk.js.map